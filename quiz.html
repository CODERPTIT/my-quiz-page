<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Kiến Trúc Máy Tính</title>
    <style>
        :root {
            --primary-color: #4a69bd;
            --secondary-color: #6a85b6;
            --correct-color: #82e0aa; /* Xanh lá nhạt hơn */
            --incorrect-color: #f1948a; /* Đỏ nhạt hơn */
            --skipped-color: #f7dc6f; /* Cam nhạt hơn */
            --light-bg: #f4f4f9;
            --white-color: #ffffff;
            --dark-text: #333;
            --background-image-url: url('https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1740&auto=format&fit=crop');
            --border-radius-main: 12px;
            --shadow-light: 0 4px 15px rgba(0,0,0,0.1);
            --shadow-medium: 0 6px 20px rgba(0,0,0,0.15);
            --shadow-deep: 0 8px 30px rgba(0,0,0,0.2);
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Font hiện đại hơn */
            color: var(--dark-text); 
            background-image: var(--background-image-url);
            background-size: cover; 
            background-position: center center; 
            background-attachment: fixed;
            margin: 0; 
            padding: 0;
            display: flex; /* Dùng flexbox cho toàn bộ body */
            flex-direction: column;
            min-height: 100vh;
        }

        header { 
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: var(--white-color); 
            padding: 30px 20px; 
            text-align: center; 
            font-size: 2.5em; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            box-shadow: var(--shadow-medium);
        }
        
        .main-content {
            flex-grow: 1; /* Cho phép nó mở rộng để chiếm không gian */
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 20px;
            justify-content: center; /* Căn giữa nội dung chính */
        }
        
        .top-right-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        #toggle-audio {
            position: relative; 
            width: 50px; height: 50px; background: rgba(255, 255, 255, 0.9); border-radius: 50%;
            border: none; cursor: pointer; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex; justify-content: center; align-items: center; transition: all 0.3s ease;
        }
        #toggle-audio:hover { transform: scale(1.1); }
        #toggle-audio svg { width: 24px; height: 24px; fill: #333; }
        
        #playlist {
            position: fixed; top: 80px; right: 20px; background: var(--white-color); border-radius: 8px;
            box-shadow: var(--shadow-light); padding: 10px; z-index: 999;
            width: 220px; display: none;
        }
        .playlist-item { padding: 12px 15px; cursor: pointer; border-radius: 6px; transition: background-color 0.2s; font-size: 0.9em; color: #333; }
        .playlist-item:hover { background-color: #f0f0f0; }
        .playlist-item.playing { background-color: var(--primary-color); color: var(--white-color); font-weight: bold; }

        #google_translate_element .goog-te-gadget-simple {
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 20px;
            padding: 8px 12px;
            box-shadow: var(--shadow-light);
        }
        #google_translate_element .goog-te-gadget-icon {
            display: none !important;
        }
        .goog-te-gadget-simple span {
            color: #333 !important;
        }

        .card-container {
            width: 100%; 
            max-width: 900px; /* Tăng max-width để màn hình bắt đầu rộng hơn */
            background: rgba(255, 255, 255, 0.97); 
            padding: 30px; 
            border-radius: var(--border-radius-main); 
            box-shadow: var(--shadow-medium); 
            margin: 20px;
            box-sizing: border-box; /* Đảm bảo padding không làm tăng kích thước tổng thể */
        }
        
        #start-screen { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            text-align: center;
        }
        #final-result-container { 
            max-width: 1000px; /* Giữ nguyên hoặc tăng tùy theo kích thước bảng kết quả */
            display: none; 
        }
        
        #chapter-selection { 
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px; /* Khoảng cách giữa các phần tử chính */
        }
        #chapter-selection label { font-size: 1.1em;}
        #chapter-selection select { 
            padding: 12px 20px; 
            font-size: 1.1em; 
            border-radius: 8px; 
            border: 1px solid #ced4da; 
            width: 80%; /* Chiếm phần lớn chiều rộng */
            max-width: 400px;
            background-color: var(--light-bg);
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            appearance: none; /* Bỏ style mặc định của select */
            -webkit-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%234a69bd%22%20d%3D%22M287%20197.3L159.2%2069.5c-4.7-4.7-12.3-4.7-17%200L5.4%20197.3c-4.7%204.7-4.7%2012.3%200%2017l7.6%207.6c4.7%204.7%2012.3%204.7%2017%200l110.1-110.1c4.7-4.7%2012.3-4.7%2017%200l110.1%20110.1c4.7%204.7%2012.3%204.7%2017%200l7.6-7.6c4.7-4.7%204.7-12.3%200-17z%22%2F%3E%3C%2Fsvg%3E'); /* Mũi tên tùy chỉnh */
            background-repeat: no-repeat;
            background-position: right 15px top 50%;
            background-size: 1em auto;
        }

        .quiz-button { 
            background-color: var(--primary-color); 
            color: var(--white-color); 
            border-color: var(--primary-color); 
            cursor: pointer; 
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s; 
            padding: 12px 25px; 
            font-size: 1.1em; 
            border-radius: 8px;
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .quiz-button:hover { 
            background-color: var(--secondary-color); 
            transform: translateY(-2px); 
            box-shadow: var(--shadow-medium);
        }
        
        /* Cập nhật #quiz-container và #quiz-layout */
        #quiz-container {
            max-width: 1200px; /* Mở rộng tối đa */
            width: 100%; /* Đảm bảo chiếm đủ chiều rộng */
            margin: 20px auto; /* Căn giữa */
            box-sizing: border-box;
        }
        #quiz-layout { 
            display: flex; 
            gap: 30px; 
            align-items: flex-start;
            width: 100%; /* Quan trọng: làm cho quiz-layout chiếm 100% của quiz-container */
        }
        #main-quiz-area { 
            flex: 3; 
            overflow-y: auto;
            max-height: calc(100vh - 200px);
            padding-right: 15px;
            position: relative; 
            /* QUAN TRỌNG: Thêm scroll-padding-top */
            scroll-padding-top: 100px; /* Điều chỉnh giá trị này lớn hơn chiều cao của quiz-header */
        }

        .quiz-header {
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            margin-bottom: 20px; 
            border-bottom: 1px solid #eee; 
            padding-bottom: 15px;
            background-color: var(--white-color); 
            padding-top: 10px; 
            position: sticky; 
            top: 0; 
            z-index: 10; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
            border-radius: 8px 8px 0 0; 
        }
        .quiz-header h2 { margin: 0; font-size: 1.6em; }
        #score-counter { margin: 0; font-size: 1em; font-weight: bold; background-color: var(--light-bg); padding: 8px 15px; border-radius: 20px; color: var(--primary-color); }
        
        .single-question-display {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            position: relative; 
        }
        .single-question-display:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        #question-nav-panel {
            flex: 1; 
            background-color: var(--light-bg); 
            border-radius: 8px;
            padding: 15px; 
            position: sticky;
            top: 20px;
            box-shadow: var(--shadow-light);
            /* Thêm overflow để cuộn */
            max-height: calc(100vh - 200px); /* Đảm bảo khớp với main-quiz-area */
            overflow-y: auto; /* Cho phép cuộn dọc khi cần */
        }
        #question-nav-panel h3 { margin-top: 0; text-align: center; border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px; }
        .nav-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); gap: 10px; }
        .nav-question-btn {
            width: 100%; height: 45px; border: 1px solid #ccc; background-color: var(--white-color);
            border-radius: 5px; cursor: pointer; transition: all 0.2s ease; font-weight: bold;
            color: var(--dark-text); 
        }
        .nav-question-btn:hover { transform: translateY(-2px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .nav-question-btn.current-question { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        /* Các màu này chỉ hiện sau khi bài test đã nộp hoặc trong chế độ luyện tập */
        .nav-question-btn.answered-correct { background-color: var(--correct-color); color: var(--dark-text); border-color: var(--correct-color); } 
        .nav-question-btn.answered-incorrect { background-color: var(--incorrect-color); color: var(--dark-text); border-color: var(--incorrect-color); } 
        .nav-question-btn.answered-skipped { background-color: var(--skipped-color); color: var(--dark-text); border-color: var(--skipped-color); } 
        /* Màu cho nút điều hướng bên phải khi đã làm (chế độ thi thử, trước khi nộp) */
        .nav-question-btn.answered-in-test {
            background-color: var(--light-bg); /* Màu nền nhạt để báo hiệu đã làm */
            color: var(--dark-text);
            border-color: #ddd;
        }


        .question-text { margin-top: 0; font-size: 1.4em; }
        
        .options {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .option-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            cursor: pointer;
            padding: 12px 20px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            pointer-events: auto; /* Mặc định cho phép tương tác */
        }

        .option-item:hover {
            background-color: #e2e6ea;
            border-color: #86b7fe;
            box-shadow: 0 0 0 0.25rem rgba(13,110,253,.25);
        }

        .option-item input[type="radio"] {
            display: none;
        }

        .custom-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #6c757d;
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            background-color: #f8f9fa;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
            position: relative;
        }

        .option-item input[type="radio"]:checked + .custom-radio {
            border-color: var(--primary-color);
            background-color: var(--primary-color);
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }

        .option-item label {
            flex-grow: 1;
            cursor: pointer;
            font-size: 1.1em;
            color: #495057;
        }

        .custom-radio .icon {
            font-family: 'Arial', sans-serif;
            font-size: 1.4em;
            font-weight: bold;
            color: #ffffff;
            line-height: 1;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
        }

        /* TRẠNG THÁI: Phủ màu toàn bộ ô đáp án khi chọn đúng/sai */
        /* Chỉ áp dụng trong chế độ luyện tập hoặc sau khi nộp bài ở chế độ test */
        .option-item.chosen-correct { /* Khi người dùng chọn đúng */
            background-color: var(--correct-color) !important;
            border-color: var(--correct-color) !important;
            box-shadow: 0 0 0 0.25rem rgba(130,224,170,.25) !important; 
        }
        .option-item.chosen-correct .custom-radio {
            background-color: var(--white-color) !important; 
            border-color: var(--white-color) !important;
        }
        .option-item.chosen-correct .custom-radio .icon {
            content: '✓';
            opacity: 1;
            transform: scale(1);
            color: var(--correct-color); 
        }
        .option-item.chosen-correct label {
            color: var(--dark-text); 
        }

        .option-item.chosen-incorrect { /* Khi người dùng chọn sai */
            background-color: var(--incorrect-color) !important;
            border-color: var(--incorrect-color) !important;
            box-shadow: 0 0 0 0.25rem rgba(241,148,138,.25) !important; 
        }
        .option-item.chosen-incorrect .custom-radio {
            background-color: var(--white-color) !important; 
            border-color: var(--white-color) !important;
        }
        .option-item.chosen-incorrect .custom-radio .icon {
            content: '✗';
            opacity: 1;
            transform: scale(1);
            color: var(--incorrect-color); 
        }
        .option-item.chosen-incorrect label {
            color: var(--dark-text); 
        }
        
        /* Highlight đáp án đúng khi người dùng chọn sai */
        /* Chỉ áp dụng trong chế độ luyện tập hoặc sau khi nộp bài ở chế độ test */
        .single-question-display.answered .option-item.correct-answer-highlight {
            background-color: var(--correct-color) !important; 
            border-color: var(--correct-color) !important;
            box-shadow: 0 0 0 0.25rem rgba(130,224,170,.25) !important;
        }
        .single-question-display.answered .option-item.correct-answer-highlight .custom-radio {
            background-color: var(--white-color) !important; 
            border-color: var(--white-color) !important;
        }
        .single-question-display.answered .option-item.correct-answer-highlight .custom-radio .icon {
            content: '✓' !important;
            opacity: 1 !important;
            transform: scale(1) !important;
            color: var(--correct-color) !important;
        }
        .single-question-display.answered .option-item.correct-answer-highlight label {
            color: var(--dark-text) !important;
        }

        /* Vô hiệu hóa tương tác cho các option của câu hỏi đã làm */
        /* Và làm mờ các option không được chọn */
        /* LƯU Ý: Quy tắc này được áp dụng sau khi nộp bài hoặc trong chế độ luyện tập */
        .single-question-display.answered .option-item {
            cursor: default;
            pointer-events: none; /* Vô hiệu hóa click cho tất cả các option của câu đã làm */
        }
        .single-question-display.answered .option-item:hover {
            background-color: initial; /* Bỏ hover */
            border-color: #ced4da;
            box-shadow: none;
        }
        .single-question-display.answered .option-item:not(.chosen-correct):not(.chosen-incorrect):not(.correct-revealed):not(.correct-answer-highlight) {
            opacity: 0.6; /* Làm mờ các đáp án không liên quan */
        }
        .single-question-display.answered .option-item:not(.chosen-correct):not(.chosen-incorrect):not(.correct-revealed):not(.correct-answer-highlight) label {
            color: #6c757d; /* Màu chữ tối cho các tùy chọn không được chọn */
        }
        .single-question-display.answered .option-item input[type="radio"] {
            pointer-events: none; /* Vô hiệu hóa radio button nếu câu hỏi đã trả lời */
        }


        /* Nút gợi ý bóng đèn */
        .hint-button {
            position: absolute;
            top: 15px; 
            right: 15px; 
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: transform 0.2s ease, opacity 0.2s ease;
            display: inline-block; 
            opacity: 0.7;
            z-index: 5; 
        }
        .hint-button:hover:not(:disabled) {
            transform: scale(1.1);
            opacity: 1;
        }
        .hint-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .hint-button img { 
            width: 30px; 
            height: 30px; 
            border-radius: 50%; 
        }

        /* Vùng hiển thị feedback (cho nút Show Answer) */
        .answer-feedback-area { 
            display: none; 
        }
        
        /* Class để làm nổi bật đáp án đúng khi nhấn "Hiện Đáp Án" */
        .option-item.correct-revealed {
            background-color: var(--skipped-color) !important; 
            border-color: var(--skipped-color) !important;
            box-shadow: 0 0 0 0.25rem rgba(247,220,111,.25) !important; 
        }
        .option-item.correct-revealed .custom-radio {
            background-color: var(--white-color) !important; 
            border-color: var(--white-color) !important;
        }
        .option-item.correct-revealed .custom-radio .icon {
            content: '✓' !important;
            opacity: 1 !important;
            transform: scale(1) !important;
            color: var(--skipped-color) !important; 
        }
        .option-item.correct-revealed label {
            color: var(--dark-text) !important; 
            font-weight: bold;
        }

        /* Styles for the new result table */
        .final-results-summary {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .final-results-summary h2 {
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .final-results-summary p {
            font-size: 1.2em;
            margin: 5px 0;
        }

        .final-results-summary p .correct {
            color: var(--correct-color);
            font-weight: bold;
        }
        .final-results-summary p .incorrect {
            color: var(--incorrect-color);
            font-weight: bold;
        }

        .final-results-table-wrapper {
            max-height: 400px; 
            overflow-y: auto;
            width: 100%;
            margin-bottom: 20px;
            padding-right: 10px; 
        }

        .final-results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0 auto; 
            box-shadow: var(--shadow-medium);
            border-radius: var(--border-radius-main);
            overflow: hidden; 
        }

        .final-results-table th, 
        .final-results-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
            font-size: 0.95em;
        }

        .final-results-table th {
            background-color: var(--primary-color);
            color: var(--white-color);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: sticky;
            top: 0;
            z-index: 1; 
        }

        .final-results-table tbody tr:nth-child(even) {
            background-color: var(--light-bg); 
        }

        .final-results-table tbody tr:hover {
            background-color: #e9e9e9;
        }

        .final-results-table .status-correct {
            color: var(--correct-color);
            font-weight: bold;
        }

        .final-results-table .status-incorrect {
            color: var(--incorrect-color);
            font-weight: bold;
        }

        .final-results-table .status-skipped {
            color: var(--skipped-color);
            font-weight: bold;
        }

        /* New styles for mode selection buttons */
        .mode-selection {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .mode-button {
            flex: 1; /* Chia đều không gian */
            max-width: 180px; /* Giới hạn kích thước */
            background-color: var(--light-bg); /* Màu nền nhẹ nhàng */
            color: var(--dark-text);
            border: 1px solid #ced4da;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            padding: 15px 20px; /* Tăng padding */
            font-size: 1.2em; /* Tăng cỡ chữ */
            font-weight: 600;
            border-radius: 10px; /* Bo tròn góc hơn */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px; /* Khoảng cách giữa icon và text */
        }
        .mode-button:hover {
            transform: translateY(-3px); /* Hiệu ứng nổi */
            box-shadow: var(--shadow-medium);
            background-color: #e9ecef; /* Nền sáng hơn khi hover */
        }

        .mode-button.selected {
            background-color: var(--primary-color);
            color: var(--white-color);
            border-color: var(--primary-color);
            transform: translateY(-1px); /* Hơi nổi lên */
            box-shadow: var(--shadow-deep);
        }
        .mode-button.selected:hover {
            background-color: var(--secondary-color);
            box-shadow: var(--shadow-deep);
        }
        .mode-button .icon {
            font-size: 2.5em; /* Kích thước icon */
            color: var(--primary-color); /* Màu icon mặc định */
        }
        .mode-button.selected .icon {
            color: var(--white-color); /* Màu icon khi được chọn */
        }

        /* Custom test duration input */
        #test-duration-option {
            margin-top: 25px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius-main);
            background-color: var(--light-bg);
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
            display: none; /* Mặc định ẩn */
            width: 80%;
            max-width: 400px;
            box-sizing: border-box;
        }
        #test-duration-option label {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
            display: inline-block;
        }
        #test-duration-option input[type="radio"] {
            display: none; /* Ẩn radio mặc định */
        }
        #test-duration-option input[type="radio"] + label {
            display: inline-flex; /* Để icon và text trên cùng một hàng */
            align-items: center;
            cursor: pointer;
            padding: 8px 15px;
            border: 1px solid #ccc;
            border-radius: 20px;
            background-color: var(--white-color);
            transition: all 0.2s ease;
            margin-right: 10px;
            font-size: 1em;
            color: var(--dark-text);
        }
        #test-duration-option input[type="radio"] + label::before {
            content: '';
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            margin-right: 8px;
            background-color: var(--white-color);
            transition: all 0.2s ease;
        }
        #test-duration-option input[type="radio"]:checked + label {
            background-color: var(--primary-color);
            color: var(--white-color);
            border-color: var(--primary-color);
        }
        #test-duration-option input[type="radio"]:checked + label::before {
            background-color: var(--white-color);
            box-shadow: inset 0 0 0 5px var(--primary-color); /* Hiệu ứng chấm tròn */
        }


        #test-minutes-container {
            margin-top: 15px;
            text-align: center;
            display: block; /* Mặc định hiển thị nếu use-timer-yes checked */
        }
        #test-minutes-container label {
            font-weight: normal;
        }
        #test-minutes-container input[type="number"] {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ced4da;
            width: 80px;
            text-align: center;
            font-size: 1.1em;
            margin-left: 10px;
        }

        /* Ẩn nút gợi ý trong chế độ Test */
        .test-mode .hint-button {
            display: none;
        }

        /* Các quy tắc cho chế độ Test TRƯỚC KHI NỘP BÀI */
        /* body.test-mode-active được thêm/xóa bằng JS khi vào/thoát chế độ test */
        body.test-mode-active .option-item {
            background-color: var(--white-color) !important; /* Luôn màu trắng */
            border-color: #ced4da !important; /* Viền xám */
            box-shadow: none !important;
            opacity: 1 !important; /* Không mờ */
            pointer-events: auto !important; /* CHO PHÉP TƯƠNG TÁC LẠI */
        }
        body.test-mode-active .option-item input[type="radio"] {
            pointer-events: auto !important; /* CHO PHÉP CHỌN RADIO BUTTON */
        }
        body.test-mode-active .option-item:hover {
             background-color: #e2e6ea !important; /* Vẫn có hover nhẹ */
        }
        body.test-mode-active .option-item .custom-radio {
            background-color: #f8f9fa !important; /* Nền radio trung tính */
            border-color: #6c757d !important; /* Viền radio trung tính */
        }
        body.test-mode-active .option-item input[type="radio"]:checked + .custom-radio {
             background-color: var(--primary-color) !important; /* Ô radio màu xanh khi chọn */
             border-color: var(--primary-color) !important;
        }
        body.test-mode-active .option-item .custom-radio .icon {
            opacity: 0 !important; /* Ẩn dấu tích/X */
        }
        body.test-mode-active .option-item label {
            color: #495057 !important; /* Màu chữ mặc định */
        }
        /* Đảm bảo các tùy chọn đã làm trong test mode vẫn vô hiệu hóa nhưng không đổi màu cho đến khi nộp */
        body.test-mode-active .single-question-display.answered .option-item {
            /* Các kiểu vô hiệu hóa sẽ được áp dụng lại sau khi nộp bài qua showResult() */
            /* Trước khi nộp bài, cho phép chọn lại */
            pointer-events: auto !important; /* Cần đảm bảo auto */
        }
        body.test-mode-active .single-question-display.answered .option-item input[type="radio"] {
            pointer-events: auto !important; /* Cần đảm bảo auto */
        }


        /* Hiển thị nút nộp bài chỉ trong chế độ Test */
        #submit-test-button {
            display: none; /* Mặc định ẩn, JS sẽ hiện */
            margin-top: 30px;
            background-color: #28a745; /* Màu xanh lá nổi bật */
            border-color: #28a745;
        }

        #submit-test-button:hover {
            background-color: #218838;
        }

        /* Căn giữa các nút ở màn hình kết quả */
        #final-result-container .quiz-button {
            margin: 10px;
        }
    </style>
</head>
<body>
    <header>
        KIẾN TRÚC MÁY TÍNH
    </header>
    
    <div class="top-right-controls">
        <div id="google_translate_element"></div>
        <button id="toggle-audio" title="Bật/Tắt nhạc">
            <svg class="icon-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
            <svg class="icon-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display:none;"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
        </button>
    </div>
    <div id="playlist"></div>

    <div class="main-content">
        <div class="card-container" id="start-screen">
            <div id="chapter-selection">
                <label for="chapter-select">Chọn chương:</label>
                <select id="chapter-select">
                    <option value="all">Tất cả</option>
                    <option value="1">Chương 1: Computer Architecture Overview</option>
                    <option value="2">Chương 2: CPU</option>
                    <option value="3">Chương 3: Cache and Memory</option>
                    <option value="4">Chương 4: Intel 8086/8088 and Assembly Programming</option>
                    <option value="5">Chương 5: IO Connection and Interface Programming</option>
                </select>
                <div class="mode-selection">
                    <button id="practice-mode-btn" class="quiz-button mode-button selected">
                        <span class="icon">📚</span>Luyện tập
                    </button>
                    <button id="test-mode-btn" class="quiz-button mode-button">
                        <span class="icon">⏱️</span>Thi thử
                    </button>
                </div>
                <div id="test-duration-option" style="display:none; margin-top: 15px;">
                    <label>Giới hạn thời gian:</label><br>
                    <input type="radio" id="use-timer-yes" name="use-timer" value="yes" checked>
                    <label for="use-timer-yes">Có</label>
                    <input type="radio" id="use-timer-no" name="use-timer" value="no">
                    <label for="use-timer-no">Không</label>

                    <div id="test-minutes-container" style="margin-top: 10px;">
                        <label for="test-minutes">Thời gian (phút):</label>
                        <input type="number" id="test-minutes" value="10" min="1" max="120" style="padding: 8px; border-radius: 5px; border: 1px solid #ccc;">
                    </div>
                </div>
                <button id="start-quiz" class="quiz-button">Bắt đầu</button>
            </div>
        </div>

        <div class="card-container" id="quiz-container" style="display: none;">
            <div id="quiz-layout">
                <div id="main-quiz-area">
                    <div class="quiz-header">
                        <h2>Câu hỏi trắc nghiệm</h2>
                        <div id="timer" style="font-size: 1.2em; font-weight: bold; color: var(--primary-color);">Thời gian: 00:00</div>
                        <div id="score-counter">Số câu đúng: 0/0</div>
                    </div>
                    <div id="all-questions-display-area"></div> 
                </div>
                <div id="question-nav-panel">
                    <h3>Danh sách câu hỏi</h3>
                    <div id="nav-grid" class="nav-grid"></div>
                </div>
            </div>
        </div>
        
        <div class="card-container" id="final-result-container" style="display: none;">
            <div id="final-result" class="final-results-summary"></div>
            <div class="final-results-table-wrapper">
                <table class="final-results-table" id="results-detail-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Câu hỏi</th>
                            <th>Đáp án của bạn</th>
                            <th>Đáp án đúng</th>
                            <th>Kết quả</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
            <button onclick="restartQuiz()" class="quiz-button">Làm lại chương này</button> 
            <button onclick="backToChapterSelection()" class="quiz-button">Chọn chương khác</button>
        </div>
    </div>

    <audio id="background-music"></audio>
    
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'vi', 
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
        const questions = [
 // CHUONG 1
//P1
    {
        "question": "What does the term \"instruction set architecture\" (ISA) refer to in computer architecture? (chương 1)",
        "options": {
        "A": "The design of input devices",
        "B": "A set of protocols for internet communication",
        "C": "Programming languages for software development",
        "D": "The set of machine language commands a CPU can execute"
        },
        "correct": "D"
    },
    {
        "question": "What is the purpose of the MMU (Memory Management Unit) in computer architecture? (chương 1)",
        "options": {
        "A": "Executing arithmetic and logic operations",
        "B": "Controlling the flow of data within the CPU",
        "C": "Translating virtual addresses to physical addresses",
        "D": "Managing input/output devices"
        },
        "correct": "C"
    },
    {
        "question": "What is the purpose of a memory hierarchy in computer architecture? (chương 1)",
        "options": {
        "A": "Managing input/output operations",
        "B": "Increasing the size of virtual memory",
        "C": "Enhancing data access speed by using different types of memory",
        "D": "Minimizing CPU clock speed"
        },
        "correct": "C"
    },
    {
        "question": "What role does the program counter (PC) play in the CPU? (chương 1)",
        "options": {
        "A": "Controlling input/output devices",
        "B": "Storing the current instruction being executed",
        "C": "Handling network communication",
        "D": "Managing memory storage"
        },
        "correct": "B"
    },
    {
        "question": "Which of the following is a common feature of Reduced Instruction Set Computing (RISC) architectures? (chương 1)",
        "options": {
        "A": "Complex instruction decoding",
        "B": "Large instruction set",
        "C": "Limited clock speed",
        "D": "Emphasis on simplicity and efficiency"
        },
        "correct": "D"
    },
    {
        "question": "Which of the following is an example of a parallel processing architecture? (chương 1)",
        "options": {
        "A": "Multi-core processor",
        "B": "Single-core processor",
        "C": "Dual-core processor",
        "D": "Quad-core processor"
        },
        "correct": "A"
    },
    {
        "question": "What is the role of the input/output (I/O) subsystem in computer architecture? (chương 1)",
        "options": {
        "A": "Facilitating communication between the CPU and external devices",
        "B": "Controlling power supply",
        "C": "Managing memory access",
        "D": "Executing arithmetic operations"
        },
        "correct": "A"
    },
    {
        "question": "In computer architecture, what is the significance of the clock speed of a CPU? (chương 1)",
        "options": {
        "A": "Managing power consumption",
        "B": "Determining the amount of cache memory",
        "C": "Controlling the display resolution",
        "D": "Measuring the processor's performance in executing instructions per second"
        },
        "correct": "D"
    },
    {
        "question": "What is the purpose of the control unit in the CPU? (chương 1)",
        "options": {
        "A": "Handling network communication",
        "B": "Performing arithmetic calculations",
        "C": "Managing memory storage",
        "D": "Controlling the flow of data within the CPU"
        },
        "correct": "D"
    },
    {
        "question": "Which technology is commonly used to improve processor performance by executing multiple instructions simultaneously? (chương 1)",
        "options": {
        "A": "Parallel processing",
        "B": "Virtualization",
        "C": "Pipelining",
        "D": "Quantum computing"
        },
        "correct": "C"
    },
    {
        "question": "What role does the ALU (Arithmetic Logic Unit) play in the CPU? (chương 1)",
        "options": {
        "A": "Controlling input and output devices",
        "B": "Executing arithmetic and logic operations",
        "C": "Managing memory access",
        "D": "Handling network protocols"
        },
        "correct": "B"
    },
    {
        "question": "Which addressing mode involves specifying the address of the operand in the instruction itself? (chương 1)",
        "options": {
        "A": "Register addressing",
        "B": "Direct addressing",
        "C": "Indirect addressing",
        "D": "Immediate addressing"
        },
        "correct": "D"
    },
    {
        "question": "Which component is responsible for temporarily storing data that the CPU needs during operations? (chương 1)",
        "options": {
        "A": "Hard disk",
        "B": "ROM (Read-Only Memory)",
        "C": "RAM (Random Access Memory)",
        "D": "Cache memory"
        },
        "correct": "D"
    },
    {
        "question": "What does the term \"von Neumann architecture\" refer to in computer systems? (chương 1)",
        "options": {
        "A": "A network communication protocol",
        "B": "A type of secondary storage",
        "C": "An algorithm for sorting data",
        "D": "A design where program instructions and data share the same memory"
        },
        "correct": "D"
    },
    {
        "question": "What is the primary function of a CPU in computer architecture? (chương 1)",
        "options": {
        "A": "Arithmetic and logic operations",
        "B": "Data storage",
        "C": "Network communication",
        "D": "Graphics rendering"
        },
        "correct": "A"
    },
    {
        "question": "In computer architecture, what is the purpose of the system bus? (chương 1)",
        "options": {
        "A": "Facilitating communication between CPU and memory",
        "B": "Managing power distribution",
        "C": "Controlling the display resolution",
        "D": "Connecting the CPU to external devices"
        },
        "correct": "A"
    },
    {
        "question": "What does the term \"pipeline hazard\" refer to in computer architecture? (chương 1)",
        "options": {
        "A": "A malfunction in the CPU cooling system",
        "B": "A security vulnerability in software",
        "C": "A network connectivity issue",
        "D": "A delay in instruction execution due to resource conflicts"
        },
        "correct": "D"
    },
    {
        "question": "Which storage device provides fast access to data but is volatile and loses its content when power is lost? (chương 1)",
        "options": {
        "A": "RAM (Random Access Memory)",
        "B": "Hard disk drive (HDD)",
        "C": "Magnetic tape",
        "D": "Solid-state drive (SSD)"
        },
        "correct": "A"
    },
    {
        "question": "Which storage technology uses magnetic fields to store data on rotating disks? (chương 1)",
        "options": {
        "A": "Flash memory",
        "B": "Hard disk drive (HDD)",
        "C": "Solid-state drive (SSD)",
        "D": "Optical disc"
        },
        "correct": "B"
    },
    {
        "question": "Which memory type retains its data even when the power is turned off? (chương 1)",
        "options": {
        "A": "Virtual memory",
        "B": "RAM",
        "C": "ROM",
        "D": "Cache memory"
        },
        "correct": "C"
    },
// p2
    {
        "question": "MFC stands for ___________ (chương 1)",
        "options": {
        "A": "Memory Find Command",
        "B": "Memory Function Complete",
        "C": "Memory Format Caches",
        "D": "Mass Format Command"
        },
        "correct": "B"
    },
    {
        "question": "______ are numbers and encoded characters, generally used as operands. (chương 1)",
        "options": {
        "A": "Data",
        "B": "Stored Values",
        "C": "Information",
        "D": "Input"
        },
        "correct": "A"
    },
    {
        "question": "The ______ format is usually used to store data. (chương 1)",
        "options": {
        "A": "Decimal",
        "B": "Octal",
        "C": "BCD",
        "D": "Hexadecimal"
        },
        "correct": "C"
    },
    {
        "question": "The ALU makes use of _______ to store the intermediate results. (chương 1)",
        "options": {
        "A": "Heap",
        "B": "Registers",
        "C": "Accumulators",
        "D": "Stack"
        },
        "correct": "C"
    },
    {
        "question": "The 8-bit encoding format used to store data in a computer is ______ (chương 1)",
        "options": {
        "A": "ANCI",
        "B": "USCII",
        "C": "EBCDIC",
        "D": "ASCII"
        },
        "correct": "C"
    },
    {
        "question": "The small extremely fast, RAM’s are called as _______ (chương 1)",
        "options": {
        "A": "Heaps",
        "B": "Accumulators",
        "C": "Stacks",
        "D": "Cache"
        },
        "correct": "D"
    },
    {
        "question": "The time delay between two successive initiations of memory operation _______ (chương 1)",
        "options": {
        "A": "Memory cycle time",
        "B": "Memory access time",
        "C": "Instruction delay",
        "D": "Memory search time"
        },
        "correct": "A"
    },
    {
        "question": "The control unit controls other units by generating ___________ (chương 1)",
        "options": {
        "A": "Command Signals",
        "B": "Transfer signals",
        "C": "Control signals",
        "D": "Timing signals"
        },
        "correct": "D"
    },
    {
        "question": "To reduce the memory access time we generally make use of ______ (chương 1)",
        "options": {
        "A": "Cache’s",
        "B": "SDRAM’s",
        "C": "Heaps",
        "D": "Higher capacity RAM’s"
        },
        "correct": "A"
    },
    {
        "question": "The I/O interface required to connect the I/O device to the bus consists of ______ (chương 1)",
        "options": {
        "A": "Address decoder and registers",
        "B": "Control circuits",
        "C": "Address decoder, registers and Control circuits",
        "D": "Only Control circuits"
        },
        "correct": "C"
    },
    {
        "question": "The Input devices can send information to the processor. (chương 1)",
        "options": {
        "A": "Either of the cases",
        "B": "When the SIN status flag is set",
        "C": "When the data arrives regardless of the SIN flag",
        "D": "Neither of the cases"
        },
        "correct": "B"
    },
    {
        "question": "A source program is usually in _______ (chương 1)",
        "options": {
        "A": "Assembly language",
        "B": "Machine level language",
        "C": "Natural language",
        "D": "High-level language"
        },
        "correct": "D"
    },
    {
        "question": "______ is generally used to increase the apparent size of physical memory. (chương 1)",
        "options": {
        "A": "Hard-disk",
        "B": "Virtual memory",
        "C": "Secondary memory",
        "D": "Disks"
        },
        "correct": "B"
    },
    {
        "question": "Which memory device is generally made of semiconductors? (chương 1)",
        "options": {
        "A": "Cd disk",
        "B": "Floppy disk",
        "C": "RAM",
        "D": "Hard-disk"
        },
        "correct": "C"
    },
    {
        "question": "______ bus structure is usually used to connect I/O devices. (chương 1)",
        "options": {
        "A": "Rambus",
        "B": "Single bus",
        "C": "Multiple bus",
        "D": "Star bus"
        },
        "correct": "B"
    },
    
    {
        "question": "The decoded instruction is stored in ______ (chương 1)",
        "options": {
        "A": "MDR",
        "B": "IR",
        "C": "PC",
        "D": "Registers"
        },
        "correct": "B"
    },
    {
        "question": "Which of the register/s of the processor is/are connected to Memory Bus? (chương 1)",
        "options": {
        "A": "MAR",
        "B": "Both PC and MAR",
        "C": "PC",
        "D": "IR"
        },
        "correct": "A"
    },
    {
        "question": "The instruction -> Add LOCA, R0 does _______ (chương 1)",
        "options": {
        "A": "Adds the value of R0 to the address of LOCA",
        "B": "Adds the value of LOCA to R0 and stores in the temp register",
        "C": "Adds the values of both LOCA and R0 and stores it in R0",
        "D": "Adds the value of LOCA with a value in accumulator and stores it in R0"
        },
        "correct": "C"
    },
    {
        "question": "During the execution of a program which gets initialized first? (chương 1)",
        "options": {
        "A": "IR",
        "B": "PC",
        "C": "MAR",
        "D": "MDR"
        },
        "correct": "B"
    },
    {
        "question": "Which registers can interact with the secondary storage? (chương 1)",
        "options": {
        "A": "PC",
        "B": "MAR",
        "C": "R0",
        "D": "IR"
        },
        "correct": "B"
    },
    {
        "question": "_______ is used to store data in registers. (chương 1)",
        "options": {
        "A": "None of the mentioned",
        "B": "D flip flop",
        "C": "JK flip flop",
        "D": "RS flip flop"
        },
        "correct": "B"
    },
    {
        "question": "The registers, ALU and the interconnection between them are collectively called as _____ (chương 1)",
        "options": {
        "A": "information path",
        "B": "information trail",
        "C": "process route",
        "D": "data path"
        },
        "correct": "D"
    },
    {
        "question": "ISP stands for _________ (chương 1)",
        "options": {
        "A": "Interchange Standard Protocol",
        "B": "Instruction Set Processor",
        "C": "Information Standard Processing",
        "D": "Interrupt Service Procedure"
        },
        "correct": "B"
    },
    {
        "question": "The internal components of the processor are connected by _______ (chương 1)",
        "options": {
        "A": "Memory bus",
        "B": "Rambus",
        "C": "Processor intra-connectivity circuitry",
        "D": "Processor bus"
        },
        "correct": "D"
    },
    {
        "question": "______ is used to choose between incrementing the PC or performing ALU operations. (chương 1)",
        "options": {
        "A": "None of the mentioned",
        "B": "Conditional codes",
        "C": "Multiplexer",
        "D": "Control unit"
        },
        "correct": "C"
    },
//p3
    {
        "question": "The decoded instruction is stored in ______ (chương 1)",
        "options": {
        "A": "MDR",
        "B": "IR",
        "C": "PC",
        "D": "Registers"
        },
        "correct": "B"
    },
    {
        "question": "Which of the register/s of the processor is/are connected to Memory Bus? (chương 1)",
        "options": {
        "A": "MAR",
        "B": "Both PC and MAR",
        "C": "PC",
        "D": "IR"
        },
        "correct": "A"
    },
    {
        "question": "The instruction -> Add LOCA, R0 does _______ (chương 1)",
        "options": {
        "A": "Adds the value of R0 to the address of LOCA",
        "B": "Adds the value of LOCA to R0 and stores in the temp register",
        "C": "Adds the values of both LOCA and R0 and stores it in R0",
        "D": "Adds the value of LOCA with a value in accumulator and stores it in R0"
        },
        "correct": "C"
    },
    {
        "question": "During the execution of a program which gets initialized first? (chương 1)",
        "options": {
        "A": "IR",
        "B": "PC",
        "C": "MAR",
        "D": "MDR"
        },
        "correct": "B"
    },
    {
        "question": "Which registers can interact with the secondary storage? (chương 1)",
        "options": {
        "A": "PC",
        "B": "MAR",
        "C": "R0",
        "D": "IR"
        },
        "correct": "B"
    },
    {
        "question": "_______ is used to store data in registers. (chương 1)",
        "options": {
        "A": "None of the mentioned",
        "B": "D flip flop",
        "C": "JK flip flop",
        "D": "RS flip flop"
        },
        "correct": "B"
    },
    {
        "question": "The registers, ALU and the interconnection between them are collectively called as _____ (chương 1)",
        "options": {
        "A": "information path",
        "B": "information trail",
        "C": "process route",
        "D": "data path"
        },
        "correct": "D"
    },
    {
        "question": "ISP stands for _________ (chương 1)",
        "options": {
        "A": "Interchange Standard Protocol",
        "B": "Instruction Set Processor",
        "C": "Information Standard Processing",
        "D": "Interrupt Service Procedure"
        },
        "correct": "B"
    },
    {
        "question": "The internal components of the processor are connected by _______ (chương 1)",
        "options": {
        "A": "Memory bus",
        "B": "Rambus",
        "C": "Processor intra-connectivity circuitry",
        "D": "Processor bus"
        },
        "correct": "D"
    },
    {
        "question": "______ is used to choose between incrementing the PC or performing ALU operations. (chương 1)",
        "options": {
        "A": "None of the mentioned",
        "B": "Conditional codes",
        "C": "Multiplexer",
        "D": "Control unit"
        },
        "correct": "C"
    },
// p4
    {
        "question": "IBM developed a bus standard for their line of computers ‘PC AT’ called _____ (chương 1)",
        "options": {
        "A": "IB bus",
        "B": "None of the mentioned",
        "C": "M-bus",
        "D": "ISA"
        },
        "correct": "D"
    },
    {
        "question": "In multiple Bus organisation, the registers are collectively placed and referred as ______ (chương 1)",
        "options": {
        "A": "Map registers",
        "B": "Set registers",
        "C": "Register Block",
        "D": "Register file"
        },
        "correct": "D"
    },
    {
        "question": "_____ register Connected to the Processor bus is a single-way transfer capable. (chương 1)",
        "options": {
        "A": "PC",
        "B": "Z",
        "C": "IR",
        "D": "Temp"
        },
        "correct": "B"
    },
    {
        "question": "______ are used to overcome the difference in data transfer speeds of various devices. (chương 1)",
        "options": {
        "A": "Bridge circuits",
        "B": "Speed enhancing circuitory",
        "C": "Buffer registers",
        "D": "Multiple Buses"
        },
        "correct": "C"
    },
    {
        "question": "To extend the connectivity of the processor bus we use ________ (chương 1)",
        "options": {
        "A": "Multiple bus",
        "B": "PCI bus",
        "C": "Controllers",
        "D": "SCSI bus"
        },
        "correct": "B"
    },
    {
        "question": "The bus used to connect the monitor to the CPU is ______ (chương 1)",
        "options": {
        "A": "Rambus",
        "B": "SCSI bus",
        "C": "PCI bus",
        "D": "Memory bus"
        },
        "correct": "B"
    },
    {
        "question": "ANSI stands for __________ (chương 1)",
        "options": {
        "A": "American National Standards Institute",
        "B": "American Network Standard Interfacing",
        "C": "American National Standard Interface",
        "D": "American Network Security Interrupt"
        },
        "correct": "A"
    },
    {
        "question": "The main advantage of multiple bus organisation over a single bus is _____ (chương 1)",
        "options": {
        "A": "Increase in size of the registers",
        "B": "Better Connectivity",
        "C": "None of the mentioned",
        "D": "Reduction in the number of cycles for execution"
        },
        "correct": "D"
    },
    {
        "question": "The main virtue for using single Bus structure is ____________ (chương 1)",
        "options": {
        "A": "None of the mentioned",
        "B": "Fast data transfers",
        "C": "Cost effective connectivity and ease of attaching peripheral devices",
        "D": "Cost effective connectivity and speed"
        },
        "correct": "C"
    },
    {
        "question": "The ISA standard Buses are used to connect ___________ (chương 1)",
        "options": {
        "A": "CD/DVD drives and Processor",
        "B": "RAM and processor",
        "C": "GPU and processor",
        "D": "Harddisk and Processor"
        },
        "correct": "D"
    },
// P5
    {
        "question": "A processor performing fetch or decoding of different instruction during the execution of another instruction is called ______ (chương 1)",
        "options": {
        "A": "Parallel Computation",
        "B": "Pipe-lining",
        "C": "None of the mentioned",
        "D": "Super-scaling"
        },
        "correct": "B"
    },
    {
        "question": "The average number of steps taken to execute the set of instructions can be made to be less than one by following _______ (chương 1)",
        "options": {
        "A": "Pipe-lining",
        "B": "ISA",
        "C": "Super-scaling",
        "D": "Sequential"
        },
        "correct": "C"
    },
    {
        "question": "CISC stands for _______ (chương 1)",
        "options": {
        "A": "Computer Integrated Sequential Compiler",
        "B": "Complex Instruction Set Computer",
        "C": "Complex Instruction Sequential Compilation",
        "D": "Complete Instruction Sequential Compilation"
        },
        "correct": "B"
    },
    {
        "question": "If a processor clock is rated as 1250 million cycles per second, then its clock period is ________ (chương 1)",
        "options": {
        "A": "1.6 * 10-9 sec",
        "B": "1.25 * 10-10 sec",
        "C": "8 * 10-10 sec",
        "D": "1.9 * 10-10 sec"
        },
        "correct": "C"
    },
    {
        "question": "When Performing a looping operation, the instruction gets stored in the ______ (chương 1)",
        "options": {
        "A": "Registers",
        "B": "System Heap",
        "C": "Cache",
        "D": "System stack"
        },
        "correct": "C"
    },
    {
        "question": "The clock rate of the processor can be improved by _________ (chương 1)",
        "options": {
        "A": "Improving the IC technology of the logic circuits",
        "B": "All of the mentioned",
        "C": "Reducing the amount of processing done in one step",
        "D": "By using the overclocking method"
        },
        "correct": "B"
    },
    {
        "question": "For a given FINITE number of instructions to be executed, which architecture of the processor provides for a faster execution? (chương 1)",
        "options": {
        "A": "Super-scalar",
        "B": "ANSA",
        "C": "ISA",
        "D": "All of the mentioned"
        },
        "correct": "A"
    },
    {
        "question": "The ultimate goal of a compiler is to ________ (chương 1)",
        "options": {
        "A": "Be able to detect even the smallest of errors",
        "B": "Be versatile",
        "C": "Reduce the clock cycles for a programming task",
        "D": "Reduce the size of the object code"
        },
        "correct": "C"
    },
    {
        "question": "An optimizing Compiler does _________ (chương 1)",
        "options": {
        "A": "Takes advantage of the type of processor and reduces its process time",
        "B": "Better compilation of the given piece of code",
        "C": "Does better memory management",
        "D": "None of the mentioned"
        },
        "correct": "A"
    },
    {
        "question": "As of 2000, the reference system to find the SPEC rating are built with _____ Processor. (chương 1)",
        "options": {
        "A": "Intel Atom SParc 300Mhz",
        "B": "Ultra SPARC -IIi 300MHZ",
        "C": "ASUS A series 450 Mhz",
        "D": "Amd Neutrino series"
        },
        "correct": "B"
    },
    {
        "question": "SPEC stands for _______ (chương 1)",
        "options": {
        "A": "Standard Processing Enhancement Corporation",
        "B": "System Processing Enhancing Code",
        "C": "System Performance Evaluation Corporation",
        "D": "Standard Performance Evaluation Code"
        },
        "correct": "C"
    },
    {
        "question": "Two processors A and B have clock frequencies of 700 Mhz and 900 Mhz respectively. Suppose A can execute an instruction with an average of 3 steps and B can execute with an average of 5 steps. For the execution of the same instruction which processor is faster? (chương 1)",
        "options": {
        "A": "B",
        "B": "Insufficient information",
        "C": "Both take the same time",
        "D": "A"
        },
        "correct": "D"
    },
    {
        "question": "As of 2000, the reference system to find the performance of a system is _____ (chương 1)",
        "options": {
        "A": "SUN II",
        "B": "Ultra SPARC 10",
        "C": "None of the mentioned",
        "D": "SUN SPARC"
        },
        "correct": "B"
    },
    {
        "question": "If the instruction, Add R1, R2, R3 is executed in a system that is pipe-lined, then the value of S is (Where S is a term of the Basic performance equation)? (chương 1)",
        "options": {
        "A": "6",
        "B": "3",
        "C": "~2",
        "D": "~1"
        },
        "correct": "D"
    },
    {
        "question": "During the execution of the instructions, a copy of the instructions is placed in the ______ (chương 1)",
        "options": {
        "A": "Cache",
        "B": "Register",
        "C": "RAM",
        "D": "System heap"
        },
        "correct": "A"
    },
// CHUONG 2
//p1p1
    {
        "question": "What is the primary function of the control unit in a CPU? (chương 2)",
        "options": {
        "A": "Handling network communication",
        "B": "Executing arithmetic operations",
        "C": "Coordinating and controlling CPU activities",
        "D": "Managing memory storage"
        },
        "correct": "C"
    },
    {
        "question": "In the context of the CPU, what is a register? (chương 2)",
        "options": {
        "A": "Output devices",
        "B": "Temporary storage locations within the CPU",
        "C": "External storage devices",
        "D": "Secondary storage units"
        },
        "correct": "B"
    },
    {
        "question": "Which unit within the CPU is responsible for executing arithmetic and logical operations? (chương 2)",
        "options": {
        "A": "Register file",
        "B": "Cache memory",
        "C": "ALU (Arithmetic Logic Unit)",
        "D": "Control Unit"
        },
        "correct": "C"
    },
    {
        "question": "What is the purpose of the Arithmetic Logic Unit (ALU) in the CPU? (chương 2)",
        "options": {
        "A": "Handling network communication",
        "B": "Managing memory storage",
        "C": "Executing arithmetic and logic operations",
        "D": "Controlling input/output devices"
        },
        "correct": "C"
    },
    {
        "question": "What does CPU stand for in computer architecture? (chương 2)",
        "options": {
        "A": "Central Processing Unit",
        "B": "Computer Peripheral Unit",
        "C": "Control and Processing Unit",
        "D": "Central Peripheral Unit"
        },
        "correct": "A"
    },
    {
        "question": "Which component is responsible for coordinating and controlling the activities of the CPU? (chương 2)",
        "options": {
        "A": "Register file",
        "B": "ALU (Arithmetic Logic Unit)",
        "C": "Cache memory",
        "D": "Control Unit"
        },
        "correct": "D"
    },
    {
        "question": "How does the CPU use the instruction register during the fetch-decode-execute cycle? (chương 2)",
        "options": {
        "A": "Controlling input/output devices",
        "B": "Managing memory storage",
        "C": "Storing the current instruction being executed",
        "D": "Handling network communication"
        },
        "correct": "C"
    },
    {
        "question": "Which component of the CPU is responsible for fetching instructions from memory? (chương 2)",
        "options": {
        "A": "Cache memory",
        "B": "Control Unit",
        "C": "Register file",
        "D": "ALU (Arithmetic Logic Unit)"
        },
        "correct": "B"
    },
    {
        "question": "What is the purpose of the cache memory in a CPU? (chương 2)",
        "options": {
        "A": "Temporarily storing frequently used data for quick access",
        "B": "Storing the operating system",
        "C": "Providing long-term storage",
        "D": "Managing input/output operations"
        },
        "correct": "A"
    },
    {
        "question": "Which type of memory is non-volatile and retains its content even when the power is turned off? (chương 2)",
        "options": {
        "A": "Virtual memory",
        "B": "Cache memory",
        "C": "RAM (Random Access Memory)",
        "D": "ROM (Read-Only Memory)"
        },
        "correct": "D"
    },
    {
        "question": "What is the significance of the fetch-decode-execute cycle in the CPU? (chương 2)",
        "options": {
        "A": "Fetching, decoding, and executing instructions in a loop",
        "B": "Executing instructions in a sequential manner",
        "C": "Managing input/output operations",
        "D": "Controlling the flow of data within the CPU"
        },
        "correct": "A"
    },
    {
        "question": "What is the purpose of the clock signal in a CPU? (chương 2)",
        "options": {
        "A": "Synchronizing and regulating the execution of instructions",
        "B": "Controlling the flow of data within the CPU",
        "C": "Executing arithmetic and logic operations",
        "D": "Managing memory access"
        },
        "correct": "A"
    },
    {
        "question": "Which part of the CPU is responsible for temporarily storing data during processing? (chương 2)",
        "options": {
        "A": "Cache memory",
        "B": "Register file",
        "C": "Control Unit",
        "D": "ALU (Arithmetic Logic Unit)"
        },
        "correct": "A"
    },
    {
        "question": "What role does the accumulator play in the CPU? (chương 2)",
        "options": {
        "A": "Storing the result of arithmetic operations",
        "B": "Managing memory storage",
        "C": "Controlling input/output devices",
        "D": "Handling network communication"
        },
        "correct": "A"
    },
    {
        "question": "Which type of memory is directly connected to the CPU and stores frequently used data? (chương 2)",
        "options": {
        "A": "Hard disk",
        "B": "ROM (Read-Only Memory)",
        "C": "Cache memory",
        "D": "RAM (Random Access Memory)"
        },
        "correct": "C"
    },
    {
        "question": "Which type of memory contains the BIOS (Basic Input/Output System) in a computer system? (chương 2)",
        "options": {
        "A": "Cache memory",
        "B": "RAM (Random Access Memory)",
        "C": "ROM (Read-Only Memory)",
        "D": "Virtual memory"
        },
        "correct": "C"
    },
    {
        "question": "What does the term \"clock speed\" refer to in the context of the CPU? (chương 2)",
        "options": {
        "A": "The speed at which data is transferred between the CPU and memory",
        "B": "The size of the cache memory",
        "C": "The number of cores in a processor",
        "D": "The frequency at which the CPU executes instructions"
        },
        "correct": "D"
    },
    {
        "question": "What is the function of the instruction register in the CPU? (chương 2)",
        "options": {
        "A": "Handling network communication",
        "B": "Controlling input/output devices",
        "C": "Managing memory storage",
        "D": "Storing the current instruction being executed"
        },
        "correct": "D"
    },
    {
        "question": "What is the purpose of the data bus in the CPU? (chương 2)",
        "options": {
        "A": "Managing power distribution",
        "B": "Connecting the CPU to external devices",
        "C": "Facilitating communication between CPU and memory",
        "D": "Controlling the display resolution"
        },
        "correct": "C"
    },
    {
        "question": "In a CPU, what is the role of the program counter (PC)? (chương 2)",
        "options": {
        "A": "Managing memory storage",
        "B": "Handling network communication",
        "C": "Storing the current instruction being executed",
        "D": "Controlling input/output devices"
        },
        "correct": "C"
    },

//p2
    {
        "question": "In a normal n-bit adder, to find out if an overflow as occurred we make use of ________ (chương 2)",
        "options": {
        "A": "Nor gate",
        "B": "Nand gate",
        "C": "And gate",
        "D": "Xor gate"
        },
        "correct": "D"
    },
    {
        "question": "For the addition of large integers, most of the systems make use of ______ (chương 2)",
        "options": {
        "A": "Full adders",
        "B": "Fast adders",
        "C": "None of the mentioned",
        "D": "Carry look-ahead adders"
        },
        "correct": "D"
    },
    {
        "question": "When we perform subtraction on -7 and 1 the answer in 2's complement form is _________ (chương 2)",
        "options": {
        "A": "0110",
        "B": "1110",
        "C": "1010",
        "D": "1000"
        },
        "correct": "D"
    },
    {
        "question": "Which method/s of representation of numbers occupies a large amount of memory than others? (chương 2)",
        "options": {
        "A": "1's & 2's compliment",
        "B": "1's complement",
        "C": "2's complement",
        "D": "Sign-magnitude"
        },
        "correct": "D"
    },
    {
        "question": "When we perform subtraction on -7 and -5 the answer in 2's complement form is ________ (chương 2)",
        "options": {
        "A": "1110",
        "B": "1010",
        "C": "0010",
        "D": "11110"
        },
        "correct": "A"
    },
    {
        "question": "Which representation is most efficient to perform arithmetic operations on the numbers? (chương 2)",
        "options": {
        "A": "None of the mentioned",
        "B": "2'S complement",
        "C": "Sign-magnitude",
        "D": "1's complement"
        },
        "correct": "B"
    },
    {
        "question": "When we subtract -3 from 2 , the answer in 2's complement form is _________ (chương 2)",
        "options": {
        "A": "1101",
        "B": "0001",
        "C": "0101",
        "D": "1001"
        },
        "correct": "C"
    },
    {
        "question": "The most efficient method followed by computers to multiply two unsigned numbers is _______ (chương 2)",
        "options": {
        "A": "Booth algorithm",
        "B": "Bit pair recording of multipliers",
        "C": "Non restoring algorithm",
        "D": "Restoring algorithm"
        },
        "correct": "B"
    },
    {
        "question": "In the implementation of a Multiplier circuit in the system we make use of _______ (chương 2)",
        "options": {
        "A": "Counter",
        "B": "Flip flop",
        "C": "Push down stack",
        "D": "Shift register"
        },
        "correct": "D"
    },
    {
        "question": "The Flag 'V' is set to 1 indicates that _____________ (chương 2)",
        "options": {
        "A": "The operation is validated",
        "B": "None of the mentioned",
        "C": "The operation has resulted in an overflow",
        "D": "The operation is valid"
        },
        "correct": "C"
    },
    {
        "question": "The processor keeps track of the results of its operations using flags called ________ (chương 2)",
        "options": {
        "A": "Conditional code flags",
        "B": "Test output flags",
        "C": "None of the mentioned",
        "D": "Type flags"
        },
        "correct": "A"
    },
    {
        "question": "In some pipelined systems, a different instruction is used to add to numbers which can affect the flags upon execution. That instruction is _______ (chương 2)",
        "options": {
        "A": "AddCC",
        "B": "SumSetCC",
        "C": "AddSetCC",
        "D": "Add++"
        },
        "correct": "C"
    },
    {
        "question": "When 1101 is used to divide 100010010 the remainder is ______ (chương 2)",
        "options": {
        "A": "1",
        "B": "11",
        "C": "0",
        "D": "101"
        },
        "correct": "A"
    },
    {
        "question": "The register used to store the flags is called as _________ (chương 2)",
        "options": {
        "A": "Log register",
        "B": "Test register",
        "C": "Flag register",
        "D": "Status register"
        },
        "correct": "D"
    },
    {
        "question": "Which method of representation has two representations for '0'? (chương 2)",
        "options": {
        "A": "Sign-magnitude",
        "B": "None of the mentioned",
        "C": "1's complement",
        "D": "2's complement"
        },
        "correct": "A"
    },
//p3
    {
        "question": "In pipeline processing, what is meant by the term \"pipeline bubble\"? (chương 2)",
        "options": {
        "A": "A wasted clock cycle due to a stalled pipeline",
        "B": "A clock speed bottleneck",
        "C": "A structural hazard",
        "D": "A delay in instruction fetching"
        },
        "correct": "A"
    },
    {
        "question": "In a CPU pipeline, what is the purpose of the instruction fetch stage? (chương 2)",
        "options": {
        "A": "Store results in registers",
        "B": "Fetch instructions from memory",
        "C": "Execute arithmetic operations",
        "D": "Decode instructions"
        },
        "correct": "B"
    },
    {
        "question": "What is the primary advantage of pipelining in terms of instruction throughput? (chương 2)",
        "options": {
        "A": "Overlapping the execution of multiple instructions",
        "B": "Eliminating the need for cache memory",
        "C": "Reducing the number of pipeline stages",
        "D": "Increasing the clock speed"
        },
        "correct": "A"
    },
    {
        "question": "What is the primary challenge associated with branch instructions in a pipeline? (chương 2)",
        "options": {
        "A": "Increasing the number of registers",
        "B": "Control hazards and pipeline stalls",
        "C": "Reducing clock speed",
        "D": "Eliminating data hazards"
        },
        "correct": "B"
    },
    {
        "question": "What is the primary goal of pipeline technique in CPU architecture? (chương 2)",
        "options": {
        "A": "Increasing instruction execution throughput",
        "B": "Reducing clock speed",
        "C": "Minimizing the number of registers",
        "D": "Eliminating cache memory"
        },
        "correct": "A"
    },
    {
        "question": "What term describes a hazard in a pipeline, where the next instruction depends on the result of the previous instruction? (chương 2)",
        "options": {
        "A": "Data hazard",
        "B": "Pipeline stall",
        "C": "Control hazard",
        "D": "Instruction fetch"
        },
        "correct": "A"
    },
    {
        "question": "What is the role of the hazard detection unit in a pipeline architecture? (chương 2)",
        "options": {
        "A": "Identifying and handling hazards",
        "B": "Eliminating cache memory",
        "C": "Controlling the clock speed",
        "D": "Preventing structural hazards"
        },
        "correct": "A"
    },
    {
        "question": "What is the purpose of the instruction issue stage in a CPU pipeline? (chương 2)",
        "options": {
        "A": "Storing results in registers",
        "B": "Decoding instructions",
        "C": "Fetching instructions from memory",
        "D": "Initiating the execution of instructions"
        },
        "correct": "D"
    },
    {
        "question": "What type of hazard occurs when an instruction is not ready to proceed to the next stage of the pipeline? (chương 2)",
        "options": {
        "A": "Pipeline stall",
        "B": "Data hazard",
        "C": "Structural hazard",
        "D": "Control hazard"
        },
        "correct": "A"
    },
    {
        "question": "In a CPU pipeline, what is the term for the time it takes to complete a single instruction from start to finish? (chương 2)",
        "options": {
        "A": "Clock cycle",
        "B": "Latency",
        "C": "Throughput",
        "D": "Pipeline bubble"
        },
        "correct": "B"
    },
    {
        "question": "What is a drawback of pipeline processing in terms of potential hazards? (chương 2)",
        "options": {
        "A": "Pipeline stalls and hazards",
        "B": "Elimination of cache memory",
        "C": "Increased clock speed",
        "D": "Reduced instruction set"
        },
        "correct": "A"
    },
    {
        "question": "In a pipeline, what is a structural hazard? (chương 2)",
        "options": {
        "A": "A delay in instruction fetching",
        "B": "A resource conflict preventing simultaneous execution",
        "C": "A delay due to data dependencies",
        "D": "A pipeline stall due to a control hazard"
        },
        "correct": "B"
    },
    {
        "question": "How does pipelining contribute to overall CPU efficiency? (chương 2)",
        "options": {
        "A": "By reducing the number of registers",
        "B": "By increasing clock speed",
        "C": "By overlapping the execution of multiple instructions",
        "D": "By eliminating cache memory"
        },
        "correct": "C"
    },
    {
        "question": "Which stage of the pipeline is responsible for decoding the instruction and determining the operation to be performed? (chương 2)",
        "options": {
        "A": "Write-back",
        "B": "Decode",
        "C": "Execute",
        "D": "Fetch"
        },
        "correct": "B"
    },
    {
        "question": "How does the use of forwarding (data hazards resolution) contribute to pipeline efficiency? (chương 2)",
        "options": {
        "A": "Eliminating the need for cache memory",
        "B": "Reducing clock speed",
        "C": "Minimizing stalls by forwarding data directly between pipeline stages",
        "D": "Increasing the number of pipeline stages"
        },
        "correct": "C"
    },
    {
        "question": "In a CPU pipeline, what is the term for an instruction that is being processed in a stage of the pipeline? (chương 2)",
        "options": {
        "A": "In-flight instruction",
        "B": "Fetch instruction",
        "C": "Stalled instruction",
        "D": "Pipeline hazard"
        },
        "correct": "A"
    },
    {
        "question": "How does pipelining impact the overall throughput of a CPU? (chương 2)",
        "options": {
        "A": "Increases the clock speed",
        "B": "Allows multiple instructions to be processed simultaneously",
        "C": "Reduces instruction execution throughput",
        "D": "Eliminates the need for cache memory"
        },
        "correct": "B"
    },
    {
        "question": "How does pipeline parallelism improve CPU performance? (chương 2)",
        "options": {
        "A": "By reducing the number of pipeline stages",
        "B": "By allowing multiple instructions to be processed simultaneously",
        "C": "By increasing the clock speed",
        "D": "By eliminating cache memory"
        },
        "correct": "B"
    },
    {
        "question": "What is the purpose of the write-back stage in a CPU pipeline? (chương 2)",
        "options": {
        "A": "Executing arithmetic operations",
        "B": "Storing results in registers",
        "C": "Decoding instructions",
        "D": "Fetching instructions from memory"
        },
        "correct": "B"
    },
    {
        "question": "What is the purpose of the pipeline stage known as \"execute\"? (chương 2)",
        "options": {
        "A": "Decoding instructions",
        "B": "Fetching instructions from memory",
        "C": "Storing results in registers",
        "D": "Performing arithmetic and logic operations"
        },
        "correct": "D"
    },
//P4
    {
        "question": "The Instruction fetch phase ends with _________ (chương 2)",
        "options": {
        "A": "Decoding the data in MDR and placing it in IR",
        "B": "Placing the address of the data into MAR",
        "C": "Placing the data from the address in MAR into MDR",
        "D": "Completing the execution of the data and placing its storage address into MAR"
        },
        "correct": "A"
    },
    {
        "question": "The two phases of executing an instruction are __________ (chương 2)",
        "options": {
        "A": "Instruction execution and storage",
        "B": "Instruction fetch and Instruction processing",
        "C": "Instruction decoding and storage",
        "D": "Instruction fetch and instruction execution"
        },
        "correct": "D"
    },
    {
        "question": "When using Branching, the usual sequencing of the PC is altered. A new instruction is loaded which is called as ______ (chương 2)",
        "options": {
        "A": "Loop target",
        "B": "Forward target",
        "C": "Branch target",
        "D": "Jump instruction"
        },
        "correct": "C"
    },
    {
        "question": "The condition flag Z is set to 1 to indicate _______ (chương 2)",
        "options": {
        "A": "The result is zero",
        "B": "The operation requires an interrupt call",
        "C": "There is no empty register available",
        "D": "The operation has resulted in an error"
        },
        "correct": "A"
    },
    {
        "question": "In a system, which has 32 registers the register id is __________ long. (chương 2)",
        "options": {
        "A": "16 bit",
        "B": "8 bits",
        "C": "5 bits",
        "D": "6 bits"
        },
        "correct": "C"
    },
    {
        "question": "The instruction, Add R1,R2,R3 in RTN is _______ (chương 2)",
        "options": {
        "A": "R3=[R1]+[R2]",
        "B": "R3<-[R1]+[R2]+[R3]",
        "C": "R3=R1+R2+R3",
        "D": "R3<-[R1]+[R2]"
        },
        "correct": "D"
    },
    {
        "question": "The instruction, Add Loc,R1 in RTN is _______ (chương 2)",
        "options": {
        "A": "AddSetCC Loc+R1",
        "B": "Not possible to write in RTN",
        "C": "R1=Loc+R1",
        "D": "R1<-[Loc]+[R1]"
        },
        "correct": "D"
    },
    {
        "question": "While using the iterative construct (Branching) in execution _____________ instruction is used to check the condition. (chương 2)",
        "options": {
        "A": "TestCondn",
        "B": "None of the mentioned",
        "C": "TestAndSet",
        "D": "Branch"
        },
        "correct": "D"
    },
    {
        "question": "RTN stands for ___________ (chương 2)",
        "options": {
        "A": "Regular Transmission Notation",
        "B": "Regular Transfer Notation",
        "C": "Register Transfer Notation",
        "D": "Register Transmission Notation"
        },
        "correct": "C"
    },
    {
        "question": "Can you perform an addition on three operands simultaneously in ALN using Add instruction? (chương 2)",
        "options": {
        "A": "Not permitted",
        "B": "Yes",
        "C": "None of the mentioned",
        "D": "Not possible using Add, we’ve to use AddSetCC"
        },
        "correct": "A"
    },
// CHUONG 3
//p1
    {
        "question": "What is a cache hit in the context of cache memory? (chương 3)",
        "options": {
        "A": "The cache is disabled",
        "B": "The requested data is in the cache",
        "C": "The cache is empty",
        "D": "The requested data is not in the cache"
        },
        "correct": "B"
    },
    {
        "question": "How does the write-through policy in cache memory differ from the write-back policy? (chương 3)",
        "options": {
        "A": "Write-back updates main memory only when cache is full",
        "B": "Write-through writes data to main memory immediately",
        "C": "Write-back writes data to main memory immediately",
        "D": "Write-through updates main memory only when cache is full"
        },
        "correct": "B"
    },
    {
        "question": "Which cache replacement policy replaces the cache line that has been unused for the longest time? (chương 3)",
        "options": {
        "A": "Least Recently Used (LRU)",
        "B": "First-In-First-Out (FIFO)",
        "C": "Most Recently Used (MRU)",
        "D": "Random Replacement"
        },
        "correct": "A"
    },
    {
        "question": "What is the relationship between cache size and access speed? (chương 3)",
        "options": {
        "A": "Cache size determines clock speed",
        "B": "Cache size does not affect access speed",
        "C": "Larger cache size results in faster access",
        "D": "Smaller cache size results in faster access"
        },
        "correct": "C"
    },
    {
        "question": "How does cache coherence ensure data consistency in a multi-core system? (chương 3)",
        "options": {
        "A": "By controlling clock speed",
        "B": "By preventing cache hits",
        "C": "By synchronizing the content of different caches",
        "D": "By increasing cache size"
        },
        "correct": "C"
    },
    {
        "question": "In a computer system, what is the purpose of the cache controller? (chương 3)",
        "options": {
        "A": "Coordinating cache access",
        "B": "Controlling input/output devices",
        "C": "Managing long-term storage",
        "D": "Executing arithmetic operations"
        },
        "correct": "A"
    },
    {
        "question": "What is the primary role of the tag in a cache memory address? (chương 3)",
        "options": {
        "A": "Determining cache hit or miss",
        "B": "Temporarily storing data",
        "C": "Managing input/output operations",
        "D": "Controlling clock speed"
        },
        "correct": "A"
    },
    {
        "question": "What is the benefit of having a multi-level cache hierarchy (e.g., L1, L2, L3)? (chương 3)",
        "options": {
        "A": "Decreased overall cache size",
        "B": "Elimination of cache hits",
        "C": "Increased overall cache size",
        "D": "Slower access times"
        },
        "correct": "C"
    },
    {
        "question": "In cache memory, what is the purpose of the Least Recently Used (LRU) algorithm? (chương 3)",
        "options": {
        "A": "Managing long-term storage",
        "B": "Controlling clock speed",
        "C": "Temporarily storing frequently used data",
        "D": "Determining cache hit or miss"
        },
        "correct": "D"
    },
    {
        "question": "What is the primary disadvantage of a direct-mapped cache? (chương 3)",
        "options": {
        "A": "Larger cache size",
        "B": "Limited associativity",
        "C": "Slower access times",
        "D": "Higher complexity"
        },
        "correct": "B"
    },
    {
        "question": "In cache memory, what is the purpose of the set-associative mapping? (chương 3)",
        "options": {
        "A": "Determining cache hit or miss",
        "B": "Controlling the clock speed",
        "C": "Coordinating cache access",
        "D": "Organizing cache lines into sets for associativity"
        },
        "correct": "D"
    },
    {
        "question": "What is the term for a situation where the requested data is not found in the cache? (chương 3)",
        "options": {
        "A": "Cache controller",
        "B": "Cache line",
        "C": "Cache hit",
        "D": "Cache miss"
        },
        "correct": "D"
    },
    {
        "question": "Which type of cache is located on the CPU chip itself? (chương 3)",
        "options": {
        "A": "Level 3 (L3) cache",
        "B": "Level 2 (L2) cache",
        "C": "Level 1 (L1) cache",
        "D": "Virtual cache"
        },
        "correct": "C"
    },
    {
        "question": "What is the purpose of prefetching in cache memory? (chương 3)",
        "options": {
        "A": "Controlling the clock speed",
        "B": "Eliminating cache misses",
        "C": "Anticipating and loading data into the cache before it is requested",
        "D": "Temporarily storing frequently used data"
        },
        "correct": "C"
    },
    {
        "question": "What is the primary purpose of cache memory in a computer system? (chương 3)",
        "options": {
        "A": "Storing long-term data",
        "B": "Providing high-speed access to frequently used data",
        "C": "Controlling the clock speed",
        "D": "Managing input/output operations"
        },
        "correct": "B"
    },
    {
        "question": "What is the purpose of a cache line in cache memory? (chương 3)",
        "options": {
        "A": "Coordinating cache access",
        "B": "Temporarily storing frequently used data",
        "C": "Storing data permanently",
        "D": "Managing input/output operations"
        },
        "correct": "B"
    },
    {
        "question": "What is the purpose of the write-back policy in cache memory? (chương 3)",
        "options": {
        "A": "Writing data to main memory immediately",
        "B": "Updating main memory only when cache is full",
        "C": "Storing data permanently",
        "D": "Temporarily storing frequently used data"
        },
        "correct": "B"
    },
    {
        "question": "How does associativity in cache memory affect its performance? (chương 3)",
        "options": {
        "A": "Higher associativity leads to faster access times",
        "B": "Lower associativity leads to faster access times",
        "C": "Associativity does not impact access times",
        "D": "Associativity determines clock speed"
        },
        "correct": "A"
    },
    {
        "question": "How does cache memory contribute to overall system performance? (chương 3)",
        "options": {
        "A": "By providing fast access to frequently used data",
        "B": "By reducing the clock speed",
        "C": "By increasing the size of main memory",
        "D": "By eliminating the need for registers"
        },
        "correct": "A"
    },
    {
        "question": "What is the impact of cache memory on power consumption in a computer system? (chương 3)",
        "options": {
        "A": "Decreased power consumption",
        "B": "Cache has no effect on power consumption",
        "C": "Power consumption is determined by clock speed",
        "D": "Increased power consumption"
        },
        "correct": "D"
    },
//P2
    {
        "question": "What is the purpose of the write-back policy in cache memory? (chương 3)",
        "options": {
        "A": "Updating main memory only when cache is full",
        "B": "Writing data to main memory immediately",
        "C": "Storing data permanently",
        "D": "Temporarily storing frequently used data"
        },
        "correct": "A"
    },
    {
        "question": "How does associativity in cache memory affect its performance? (chương 3)",
        "options": {
        "A": "Higher associativity leads to faster access times",
        "B": "Lower associativity leads to faster access times",
        "C": "Associativity does not impact access times",
        "D": "Associativity determines clock speed"
        },
        "correct": "A"
    },
    {
        "question": "How does cache memory contribute to overall system performance? (chương 3)",
        "options": {
        "A": "By increasing the size of main memory",
        "B": "By eliminating the need for registers",
        "C": "By reducing the clock speed",
        "D": "By providing fast access to frequently used data"
        },
        "correct": "D"
    },
    {
        "question": "What is the purpose of a cache line in cache memory? (chương 3)",
        "options": {
        "A": "Temporarily storing frequently used data",
        "B": "Storing data permanently",
        "C": "Managing input/output operations",
        "D": "Coordinating cache access"
        },
        "correct": "A"
    },
    {
        "question": "What is the primary role of the tag in a cache memory address? (chương 3)",
        "options": {
        "A": "Controlling clock speed",
        "B": "Temporarily storing data",
        "C": "Determining cache hit or miss",
        "D": "Managing input/output operations"
        },
        "correct": "C"
    },
    {
        "question": "What is the relationship between cache size and access speed? (chương 3)",
        "options": {
        "A": "Cache size determines clock speed",
        "B": "Smaller cache size results in faster access",
        "C": "Cache size does not affect access speed",
        "D": "Larger cache size results in faster access"
        },
        "correct": "D"
    },
    {
        "question": "What is the purpose of prefetching in cache memory? (chương 3)",
        "options": {
        "A": "Eliminating cache misses",
        "B": "Anticipating and loading data into the cache before it is requested",
        "C": "Controlling the clock speed",
        "D": "Temporarily storing frequently used data"
        },
        "correct": "B"
    },
    {
        "question": "How does cache coherence ensure data consistency in a multi-core system? (chương 3)",
        "options": {
        "A": "By preventing cache hits",
        "B": "By synchronizing the content of different caches",
        "C": "By controlling clock speed",
        "D": "By increasing cache size"
        },
        "correct": "B"
    },
    {
        "question": "How does the write-through policy in cache memory differ from the write-back policy? (chương 3)",
        "options": {
        "A": "Write-back writes data to main memory immediately",
        "B": "Write-through updates main memory only when cache is full",
        "C": "Write-through writes data to main memory immediately",
        "D": "Write-back updates main memory only when cache is full"
        },
        "correct": "C"
    },
    {
        "question": "What is a cache hit in the context of cache memory? (chương 3)",
        "options": {
        "A": "The cache is disabled",
        "B": "The requested data is not in the cache",
        "C": "The cache is empty",
        "D": "The requested data is in the cache"
        },
        "correct": "D"
    },
    {
        "question": "In cache memory, what is the purpose of the Least Recently Used (LRU) algorithm? (chương 3)",
        "options": {
        "A": "Managing long-term storage",
        "B": "Temporarily storing frequently used data",
        "C": "Determining cache hit or miss",
        "D": "Controlling clock speed"
        },
        "correct": "C"
    },
    {
        "question": "Which cache replacement policy replaces the cache line that has been unused for the longest time? (chương 3)",
        "options": {
        "A": "First-In-First-Out (FIFO)",
        "B": "Random Replacement",
        "C": "Least Recently Used (LRU)",
        "D": "Most Recently Used (MRU)"
        },
        "correct": "C"
    },
    {
        "question": "What is the impact of cache memory on power consumption in a computer system? (chương 3)",
        "options": {
        "A": "Power consumption is determined by clock speed",
        "B": "Cache has no effect on power consumption",
        "C": "Decreased power consumption",
        "D": "Increased power consumption"
        },
        "correct": "D"
    },
    {
        "question": "What is the term for a situation where the requested data is not found in the cache? (chương 3)",
        "options": {
        "A": "Cache miss",
        "B": "Cache hit",
        "C": "Cache line",
        "D": "Cache controller"
        },
        "correct": "A"
    },
    {
        "question": "What is the primary disadvantage of a direct-mapped cache? (chương 3)",
        "options": {
        "A": "Larger cache size",
        "B": "Slower access times",
        "C": "Limited associativity",
        "D": "Higher complexity"
        },
        "correct": "C"
    },
    {
        "question": "In cache memory, what is the purpose of the set-associative mapping? (chương 3)",
        "options": {
        "A": "Determining cache hit or miss",
        "B": "Organizing cache lines into sets for associativity",
        "C": "Coordinating cache access",
        "D": "Controlling the clock speed"
        },
        "correct": "B"
    },
    {
        "question": "Which type of cache is located on the CPU chip itself? (chương 3)",
        "options": {
        "A": "Level 3 (L3) cache",
        "B": "Level 1 (L1) cache",
        "C": "Level 2 (L2) cache",
        "D": "Virtual cache"
        },
        "correct": "B"
    },
    {
        "question": "What is the primary purpose of cache memory in a computer system? (chương 3)",
        "options": {
        "A": "Managing input/output operations",
        "B": "Controlling the clock speed",
        "C": "Providing high-speed access to frequently used data",
        "D": "Storing long-term data"
        },
        "correct": "C"
    },
    {
        "question": "In a computer system, what is the purpose of the cache controller? (chương 3)",
        "options": {
        "A": "Managing long-term storage",
        "B": "Controlling input/output devices",
        "C": "Executing arithmetic operations",
        "D": "Coordinating cache access"
        },
        "correct": "D"
    },
    {
        "question": "What is the benefit of having a multi-level cache hierarchy (e.g., L1, L2, L3)? (chương 3)",
        "options": {
        "A": "Elimination of cache hits",
        "B": "Decreased overall cache size",
        "C": "Slower access times",
        "D": "Increased overall cache size"
        },
        "correct": "D"
    },
//CHUONG 4
    {
        "question": "The type of memory assignment used in Intel processors is _____ (chương 4)",
        "options": {
        "A": "Medium Endian",
        "B": "Big Endian",
        "C": "None of the mentioned",
        "D": "Little Endian"
        },
        "correct": "D"
    },
    {
        "question": "To get the physical address from the logical address generated by CPU we use ____________ (chương 4)",
        "options": {
        "A": "MAR",
        "B": "MMU",
        "C": "Overlays",
        "D": "TLB"
        },
        "correct": "B"
    },
    {
        "question": "The collection of the above mentioned entities where data is stored is called ______ (chương 4)",
        "options": {
        "A": "Block",
        "B": "Word",
        "C": "Set",
        "D": "Byte"
        },
        "correct": "B"
    },
    {
        "question": "Physical memory is divided into sets of finite size called as ______ (chương 4)",
        "options": {
        "A": "Vectors",
        "B": "Frames",
        "C": "Pages",
        "D": "Blocks"
        },
        "correct": "B"
    },
    {
        "question": "During the transfer of data between the processor and memory we use ______ (chương 4)",
        "options": {
        "A": "TLB",
        "B": "Cache",
        "C": "Registers",
        "D": "Buffers"
        },
        "correct": "C"
    },
    {
        "question": "The smallest entity of memory is called _______ (chương 4)",
        "options": {
        "A": "Cell",
        "B": "Instance",
        "C": "Unit",
        "D": "Block"
        },
        "correct": "A"
    },
    {
        "question": "If a system is 64 bit machine, then the length of each word will be _______ (chương 4)",
        "options": {
        "A": "12 bytes",
        "B": "8 bytes",
        "C": "16 bytes",
        "D": "4 bytes"
        },
        "correct": "B"
    },
    {
        "question": "_____ method is used to map logical addresses of variable length onto physical memory. (chương 4)",
        "options": {
        "A": "Segmentation",
        "B": "Overlays",
        "C": "Paging with segmentation",
        "D": "Paging"
        },
        "correct": "A"
    },
    {
        "question": "An 24 bit address generates an address space of ______ locations. (chương 4)",
        "options": {
        "A": "4096",
        "B": "248",
        "C": "1024",
        "D": "16,777,216"
        },
        "correct": "D"
    },
    {
        "question": "When using the Big Endian assignment to store a number, the sign bit of the number is stored in _____ (chương 4)",
        "options": {
        "A": "None of the mentioned",
        "B": "The higher order byte of the word",
        "C": "Can’t say",
        "D": "The lower order byte of the word"
        },
        "correct": "B"
    },
//p2
    {
        "question": "Does the Load instruction do the following operation/s? (chương 4)",
        "options": {
        "A": "Loads the contents of a location onto the accumulators",
        "B": "Loads the contents of a disc onto a memory location",
        "C": "Load the contents of the PCB onto the register",
        "D": "None of the mentioned"
        },
        "correct": "A"
    },
    {
        "question": "The instruction, Add #45,R1 does _______ (chương 4)",
        "options": {
        "A": "Finds the memory location 45 and adds that content to that of R1",
        "B": "None of the mentioned",
        "C": "Adds the value of 45 to the address of R1 and stores 45 in that address",
        "D": "Adds 45 to the value of R1 and stores it in R1"
        },
        "correct": "D"
    },
    {
        "question": "The BOOT sector files of the system are stored in ___________ (chương 4)",
        "options": {
        "A": "Fast solid state chips in the motherboard",
        "B": "Harddisk",
        "C": "ROM",
        "D": "RAM"
        },
        "correct": "C"
    },
    {
        "question": "Complete the following analogy:- Registers are to RAM’s as Cache’s are to ___________ (chương 4)",
        "options": {
        "A": "Overlays",
        "B": "System stacks",
        "C": "Page Table",
        "D": "TLB"
        },
        "correct": "D"
    },
    {
        "question": "_____ addressing mode is most suitable to change the normal sequence of execution of instructions. (chương 4)",
        "options": {
        "A": "Indirect",
        "B": "Immediate",
        "C": "Relative",
        "D": "Index with Offset"
        },
        "correct": "C"
    },
    {
        "question": "Add #45, when this instruction is executed the following happen/s _______ (chương 4)",
        "options": {
        "A": "None of the mentioned",
        "B": "The processor raises an error and requests for one more operand",
        "C": "The value 45 gets added to the value on the stack and is pushed onto the stack",
        "D": "The value stored in memory location 45 is retrieved and one more operand is requested"
        },
        "correct": "D"
    },
    {
        "question": "The transfer of large chunks of data with the involvement of the processor is done by _______ (chương 4)",
        "options": {
        "A": "User system programs",
        "B": "DMA controller",
        "C": "Arbitrator",
        "D": "None of the mentioned"
        },
        "correct": "B"
    },
    {
        "question": "The technique used to store programs larger than the memory is ____________ (chương 4)",
        "options": {
        "A": "Both Extension registers and Buffers",
        "B": "Overlays",
        "C": "Extension registers",
        "D": "Buffers"
        },
        "correct": "B"
    },
    {
        "question": "The addressing mode, where you directly specify the operand value is _______ (chương 4)",
        "options": {
        "A": "Direct",
        "B": "Relative",
        "C": "Immediate",
        "D": "Definite"
        },
        "correct": "C"
    },
    {
        "question": "The addressing mode/s, which uses the PC instead of a general purpose register is ______ (chương 4)",
        "options": {
        "A": "Relative",
        "B": "Direct",
        "C": "Indexed with offset",
        "D": "Both Indexed with offset and direct"
        },
        "correct": "A"
    },
    {
        "question": "When generating physical addresses from a logical address the offset is stored in __________ (chương 4)",
        "options": {
        "A": "Shift register",
        "B": "Page table",
        "C": "Translation look-aside buffer",
        "D": "Relocation register"
        },
        "correct": "D"
    },
    {
        "question": "If we want to perform memory or arithmetic operations on data in Hexa-decimal mode then we use _________ symbol before the operand. (chương 4)",
        "options": {
        "A": "~",
        "B": "*",
        "C": "!",
        "D": "$"
        },
        "correct": "D"
    },
    {
        "question": "The effective address of the following instruction is MUL 5(R1,R2). (chương 4)",
        "options": {
        "A": "5+R1+R2",
        "B": "5*([R1]+[R2])",
        "C": "5+[R1]+[R2]",
        "D": "5+(R1*R2)"
        },
        "correct": "C"
    },
    {
        "question": "Which of the following techniques used to effectively utilize main memory? (chương 4)",
        "options": {
        "A": "Dynamic loading",
        "B": "Dynamic linking",
        "C": "Both Dynamic linking and loading",
        "D": "Address binding"
        },
        "correct": "A"
    },
    {
        "question": "The unit which acts as an intermediate agent between memory and backing store to reduce process time is ___________ (chương 4)",
        "options": {
        "A": "TLB’s",
        "B": "Cache",
        "C": "Page tables",
        "D": "Registers"
        },
        "correct": "B"
    },
    {
        "question": "When we use auto increment or auto decrements, which of the following is/are true? 1) In both, the address is used to retrieve the operand and then the address gets altered; 2) In auto increment, the operand is retrieved first and then the address altered; 3) Both of them can be used on general purpose registers as well as memory locations (chương 4)",
        "options": {
        "A": "2, 3",
        "B": "1, 3",
        "C": "2",
        "D": "1, 2, 3"
        },
        "correct": "A"
    },
    {
        "question": "The addressing mode which makes use of in-direction pointers is ______ (chương 4)",
        "options": {
        "A": "Relative addressing mode",
        "B": "Index addressing mode",
        "C": "Offset addressing mode",
        "D": "Indirect addressing mode"
        },
        "correct": "D"
    },
    {
        "question": "Add #%01011101,R1 , when this instruction is executed then _________ (chương 4)",
        "options": {
        "A": "The binary addition between the operands takes place",
        "B": "The addition doesn’t take place, whereas this is similar to a MOV instruction",
        "C": "None of the mentioned",
        "D": "The Numerical value represented by the binary value is added to the value of R1"
        },
        "correct": "A"
    },
    {
        "question": "a) EA = 5+R1 (chương 4)",
        "options": {
        "A": "EA = 5+[R1]",
        "B": "EA = [R1]",
        "C": "EA = R1"
        },
        "correct": "A"
    },
    {
        "question": "In the case of, Zero-address instruction method the operands are stored in _____ (chương 4)",
        "options": {
        "A": "Accumulators",
        "B": "Cache",
        "C": "Registers",
        "D": "Push down stack"
        },
        "correct": "D"
    },
//p3
    {
        "question": "The location to return to, from the subroutine is stored in _______ (chương 4)",
        "options": {
        "A": "Link registers",
        "B": "PC",
        "C": "MAR",
        "D": "TLB"
        },
        "correct": "A"
    },
    {
        "question": "The appropriate return addresses are obtained with the help of ____ in case of nested routines. (chương 4)",
        "options": {
        "A": "Stack-pointers",
        "B": "MAR",
        "C": "Buffers",
        "D": "MDR"
        },
        "correct": "A"
    },
    {
        "question": "In case of nested subroutines the return addresses are stored in __________ (chương 4)",
        "options": {
        "A": "Processor stack",
        "B": "Registers",
        "C": "System heap",
        "D": "Special memory buffers"
        },
        "correct": "A"
    },
    {
        "question": "The most Flexible way of logging the return addresses of the subroutines is by using _______ (chương 4)",
        "options": {
        "A": "Registers",
        "B": "None of the mentioned",
        "C": "Stacks",
        "D": "Memory locations"
        },
        "correct": "C"
    },
    {
        "question": "What is subroutine nesting? (chương 4)",
        "options": {
        "A": "Having one routine call the other",
        "B": "Using a linking nest statement to put many subroutines under the same name",
        "C": "None of the mentioned",
        "D": "Having multiple subroutines in a program"
        },
        "correct": "A"
    },
    {
        "question": "The order in which the return addresses are generated and used is _________ (chương 4)",
        "options": {
        "A": "Highest priority",
        "B": "FIFO",
        "C": "LIFO",
        "D": "Random"
        },
        "correct": "C"
    },
    {
        "question": "When parameters are being passed on to the subroutines they are stored in ________ (chương 4)",
        "options": {
        "A": "Processor stacks",
        "B": "All of the mentioned",
        "C": "Memory locations",
        "D": "Registers"
        },
        "correct": "B"
    },
    {
        "question": "The return address of the Sub-routine is pointed to by _______ (chương 4)",
        "options": {
        "A": "MAR",
        "B": "PC",
        "C": "Special memory registers",
        "D": "IR"
        },
        "correct": "B"
    },
    {
        "question": "The most efficient way of handling parameter passing is by using ______ (chương 4)",
        "options": {
        "A": "None of the mentioned",
        "B": "Memory locations",
        "C": "Stacks",
        "D": "General purpose registers"
        },
        "correct": "D"
    },
    {
        "question": "The wrong statement/s regarding interrupts and subroutines among the following is/are ______. i) The sub-routine and interrupts have a return statement; ii) Both of them alter the content of the PC; iii) Both are software oriented; iv) Both can be initiated by the user (chương 4)",
        "options": {
        "A": "iv",
        "B": "i, ii and iv",
        "C": "iii and iv",
        "D": "ii and iii"
        },
        "correct": "C"
    },
//p4
    {
        "question": "The data structure suitable for scheduling processes is _______ (chương 4)",
        "options": {
        "A": "Stack",
        "B": "Heap",
        "C": "Queue",
        "D": "List"
        },
        "correct": "C"
    },
    {
        "question": "The sub-routine service procedure is similar to that of the interrupt service routine in ________ (chương 4)",
        "options": {
        "A": "Process execution",
        "B": "Returning",
        "C": "Method of context switch and Process execution",
        "D": "Method of context switch"
        },
        "correct": "C"
    },
    {
        "question": "______ pointer is used to point to parameters passed or local parameters of the subroutine. (chương 4)",
        "options": {
        "A": "Frame pointer",
        "B": "Parameter register",
        "C": "Log register",
        "D": "Stack pointer"
        },
        "correct": "A"
    },
    {
        "question": "If the subroutine exceeds the private space allocated to it then the values are pushed onto _________ (chương 4)",
        "options": {
        "A": "Stack",
        "B": "Reserve Space",
        "C": "System heap",
        "D": "Stack frame"
        },
        "correct": "A"
    },
    {
        "question": "The private work space dedicated to a subroutine is called as ________ (chương 4)",
        "options": {
        "A": "Stack frame",
        "B": "Reserve",
        "C": "System heap",
        "D": "Allocation"
        },
        "correct": "A"
    },
    {
        "question": "The reserved memory or private space of the subroutine gets deallocated when _______ (chương 4)",
        "options": {
        "A": "The stop instruction is executed by the routine",
        "B": "When the routine’s return statement is executed",
        "C": "None of the mentioned",
        "D": "The pointer reaches the end of the space"
        },
        "correct": "B"
    },
    {
        "question": "The private space gets allocated to each subroutine when _________ (chương 4)",
        "options": {
        "A": "When the context switch takes place",
        "B": "When the Allocate instruction is executed",
        "C": "The first statement of the routine is executed",
        "D": "When the routine gets called"
        },
        "correct": "D"
    },
    {
        "question": "In the case of nested subroutines, the stack top is always _________ (chương 4)",
        "options": {
        "A": "The saved contents of the called sub routine",
        "B": "None of the mentioned",
        "C": "The saved contents of the calling sub routine",
        "D": "The return addresses of the called sub routine"
        },
        "correct": "A"
    },
    {
        "question": "The stack frame for each subroutine is present in ______ (chương 4)",
        "options": {
        "A": "None of the mentioned",
        "B": "System Heap",
        "C": "Main memory",
        "D": "Processor Stack"
        },
        "correct": "D"
    },
    {
        "question": "_____ the most suitable data structure used to store the return addresses in the case of nested subroutines. (chương 4)",
        "options": {
        "A": "List",
        "B": "Heap",
        "C": "Queue",
        "D": "Stack"
        },
        "correct": "D"
    },
// CHUONG 5
//p1
    {
        "question": "It is ______ that in Intel IA-32 architecture there is a separate 16 bit address space for the I/O devices. (chương 5)",
        "options": {
        "A": "True",
        "B": "False",
        "C": "Not possible",
        "D": "Not determined"
        },
        "correct": "A"
    },
    {
        "question": "The advantage of I/O mapped devices to memory mapped is ___________ (chương 5)",
        "options": {
        "A": "The devices have to deal with fewer address lines",
        "B": "No advantage as such",
        "C": "The former offers faster transfer of data",
        "D": "The devices connected using I/O mapping have a bigger buffer space"
        },
        "correct": "A"
    },
    {
        "question": "The usual BUS structure used to connect the I/O devices is ___________ (chương 5)",
        "options": {
        "A": "Star BUS structure",
        "B": "Multiple BUS structure",
        "C": "Node to Node BUS structure",
        "D": "Single BUS structure"
        },
        "correct": "D"
    },
    {
        "question": "In memory-mapped I/O ____________ (chương 5)",
        "options": {
        "A": "The memory and I/O devices have an associated address space",
        "B": "A part of the memory is specifically set aside for the I/O operation",
        "C": "The I/O devices have a separate address space",
        "D": "The I/O devices and the memory share the same address space"
        },
        "correct": "D"
    },
    {
        "question": "The system is notified of a read or write operation by ___________ (chương 5)",
        "options": {
        "A": "Appending an extra bit of the address",
        "B": "Enabling the read or write bits of the devices",
        "C": "Raising an appropriate interrupt signal",
        "D": "Sending a special signal along the BUS"
        },
        "correct": "D"
    },
    {
        "question": "To overcome the lag in the operating speeds of the I/O device and the processor we use ___________ (chương 5)",
        "options": {
        "A": "Exceptions",
        "B": "Status flags",
        "C": "BUffer spaces",
        "D": "Interrupt signals"
        },
        "correct": "B"
    },
    {
        "question": "The method which offers higher speeds of I/O transfers is ___________ (chương 5)",
        "options": {
        "A": "Program-controlled I/O",
        "B": "DMA",
        "C": "Memory mapping",
        "D": "Interrupts"
        },
        "correct": "B"
    },
    {
        "question": "The process wherein the processor constantly checks the status flags is called as ___________ (chương 5)",
        "options": {
        "A": "Reviewing",
        "B": "Polling",
        "C": "Inspection",
        "D": "Echoing"
        },
        "correct": "B"
    },
    {
        "question": "The method of accessing the I/O devices by repeatedly checking the status flags is ___________ (chương 5)",
        "options": {
        "A": "None of the mentioned",
        "B": "Program-controlled I/O",
        "C": "Memory-mapped I/O",
        "D": "I/O mapped"
        },
        "correct": "B"
    },
    {
        "question": "The method of synchronising the processor with the I/O device in which the device sends a signal when it is ready is? (chương 5)",
        "options": {
        "A": "Exceptions",
        "B": "Interrupts",
        "C": "DMA",
        "D": "Signal handling"
        },
        "correct": "B"
    },
//p2
    {
        "question": "In daisy chaining device 0 will pass the signal only if it has _______ (chương 5)",
        "options": {
        "A": "No interrupt request",
        "B": "None of the mentioned",
        "C": "Interrupt request",
        "D": "Both No interrupt and Interrupt request"
        },
        "correct": "A"
    },
    {
        "question": "Interrupts form an important part of _____ systems. (chương 5)",
        "options": {
        "A": "Multi-user",
        "B": "Multitasking",
        "C": "Batch processing",
        "D": "Real-time processing"
        },
        "correct": "D"
    },
    {
        "question": "______ type circuits are generally used for interrupt service lines. i) open-collector; ii) open-drain; iii) XOR; iv) XNOR (chương 5)",
        "options": {
        "A": "ii",
        "B": "ii, iv",
        "C": "i, ii",
        "D": "ii, iii"
        },
        "correct": "C"
    },
    {
        "question": "How can the processor ignore other interrupts when it is servicing one ___________ (chương 5)",
        "options": {
        "A": "By turning off the interrupt request line",
        "B": "All of the mentioned",
        "C": "BY using edge-triggered request lines",
        "D": "By disabling the devices from sending the interrupts"
        },
        "correct": "B"
    },
    {
        "question": "In vectored interrupts, how does the device identify itself to the processor? (chương 5)",
        "options": {
        "A": "None of the mentioned",
        "B": "By sending the starting address of the service routine",
        "C": "By sending the machine code for the interrupt service routine",
        "D": "By sending its device id"
        },
        "correct": "B"
    },
    {
        "question": "Interrupts initiated by an instruction is called as _______ (chương 5)",
        "options": {
        "A": "Hardware",
        "B": "External",
        "C": "Internal",
        "D": "Software"
        },
        "correct": "D"
    },
    {
        "question": "______ interrupt method uses register whose bits are set separately by interrupt signal for each device. (chương 5)",
        "options": {
        "A": "Daisy chaining",
        "B": "Serial priority interrupt",
        "C": "None of the mentioned",
        "D": "Parallel priority interrupt"
        },
        "correct": "D"
    },
    {
        "question": "An interrupt that can be temporarily ignored is ___________ (chương 5)",
        "options": {
        "A": "High priority interrupt",
        "B": "Non-maskable interrupt",
        "C": "Vectored interrupt",
        "D": "Maskable interrupt"
        },
        "correct": "D"
    },
    {
        "question": "The starting address sent by the device in vectored interrupt is called as __________ (chương 5)",
        "options": {
        "A": "Interrupt vector",
        "B": "Location id",
        "C": "Service id",
        "D": "Service location"
        },
        "correct": "A"
    },
    {
        "question": "The interrupt-request line is a part of the ___________ (chương 5)",
        "options": {
        "A": "Control line",
        "B": "Data line",
        "C": "None of the mentioned",
        "D": "Address line"
        },
        "correct": "A"
    },
    {
        "question": "The signal sent to the device from the processor to the device after receiving an interrupt is ___________ (chương 5)",
        "options": {
        "A": "Service signal",
        "B": "Return signal",
        "C": "Interrupt-acknowledge",
        "D": "Permission signal"
        },
        "correct": "C"
    },
    {
        "question": "We describe a protocol of input device communication below: i) Each device has a distinct address. ii) The BUS controller scans each device in a sequence of increasing address value to determine if the entity wishes to communicate. iii) The device ready to communicate leaves its data in the I/O register. iv) The data is picked up and the controller moves to the step i). Identify the form of communication best describes the I/O mode amongst the following. (chương 5)",
        "options": {
        "A": "Polling",
        "B": "Interrupt mode",
        "C": "Programmed mode of data transfer",
        "D": "DMA"
        },
        "correct": "A"
    },
    {
        "question": "The added output of the bits of the interrupt register and the mask register is set as an input of ______________ (chương 5)",
        "options": {
        "A": "Multiplexer",
        "B": "Process id encoder",
        "C": "Priority decoder",
        "D": "Priority encoder"
        },
        "correct": "D"
    },
    {
        "question": "The return address from the interrupt-service routine is stored on the ___________ (chương 5)",
        "options": {
        "A": "Processor register",
        "B": "Memory",
        "C": "Processor stack",
        "D": "System heap"
        },
        "correct": "C"
    },
    {
        "question": "The time between the receiver of an interrupt and its service is ______ (chương 5)",
        "options": {
        "A": "Interrupt latency",
        "B": "Interrupt delay",
        "C": "Switching time",
        "D": "Cycle time"
        },
        "correct": "A"
    },
    {
        "question": "_________ method is used to establish priority by serially connecting all devices that request an interrupt. (chương 5)",
        "options": {
        "A": "Daisy chain",
        "B": "Vectored-interrupting",
        "C": "Priority",
        "D": "Polling"
        },
        "correct": "A"
    },
    {
        "question": "______________ register is used for the purpose of controlling the status of each interrupt request in parallel priority interrupt. (chương 5)",
        "options": {
        "A": "Mass",
        "B": "Mask",
        "C": "Mark",
        "D": "Make"
        },
        "correct": "B"
    },
    {
        "question": "It is ______ that a single interrupt line can be used to service n different devices. (chương 5)",
        "options": {
        "A": "True",
        "B": "Possible",
        "C": "Not determined",
        "D": "False"
        },
        "correct": "A"
    },
    {
        "question": "When dealing with multiple devices interrupts, which mechanism is easy to implement? (chương 5)",
        "options": {
        "A": "Polling method",
        "B": "Vectored interrupts",
        "C": "Interrupt nesting",
        "D": "None of the mentioned"
        },
        "correct": "A"
    },
    {
        "question": "Which interrupt is unmaskable? (chương 5)",
        "options": {
        "A": "Both RST 5.5 and 7.5",
        "B": "TRAP",
        "C": "RST 5.5",
        "D": "RST 7.5"
        },
        "correct": "B"
    },
    {
        "question": "The resistor which is attached to the service line is called _____ (chương 5)",
        "options": {
        "A": "Push-down resistor",
        "B": "Line resistor",
        "C": "Pull-up resistor",
        "D": "Break down resistor"
        },
        "correct": "C"
    },
    {
        "question": "The code sent by the device in vectored interrupt is _____ long. (chương 5)",
        "options": {
        "A": "upto 16 bits",
        "B": "upto 32 bits",
        "C": "4-8 bits",
        "D": "upto 24 bits"
        },
        "correct": "C"
    },
    {
        "question": "The processor indicates to the devices that it is ready to receive interrupts ________ (chương 5)",
        "options": {
        "A": "None of the mentioned",
        "B": "By activating the interrupt acknowledge line",
        "C": "By enabling the interrupt request line",
        "D": "By enabling the IRQ bits"
        },
        "correct": "B"
    },
    {
        "question": "Which table handle stores the addresses of the interrupt handling sub-routines? (chương 5)",
        "options": {
        "A": "Interrupt-vector table",
        "B": "Vector table",
        "C": "None of the mentioned",
        "D": "Symbol link table"
        },
        "correct": "A"
    },
    {
        "question": "The interrupt servicing mechanism in which the requesting device identifies itself to the processor to be serviced is ___________ (chương 5)",
        "options": {
        "A": "Interrupt nesting",
        "B": "Simultaneous requesting",
        "C": "Polling",
        "D": "Vectored interrupts"
        },
        "correct": "D"
    },
    {
        "question": "CPU as two modes privileged and non-privileged. In order to change the mode from privileged to non-privileged. (chương 5)",
        "options": {
        "A": "A software interrupt is needed",
        "B": "A non-privileged instruction (which does not generate an interrupt) is needed",
        "C": "A hardware interrupt is needed",
        "D": "Either hardware or software interrupt is needed"
        },
        "correct": "A"
    },
    {
        "question": "When the process is returned after an interrupt service ______ should be loaded again. i) Register contents; ii) Condition codes; iii) Stack contents; iv) Return addresses (chương 5)",
        "options": {
        "A": "ii, iii and iv",
        "B": "iii, iv",
        "C": "i, iv",
        "D": "i, ii"
        },
        "correct": "D"
    },
    {
        "question": "The 8085 microprocessor responds to the presence of an interrupt ___________ (chương 5)",
        "options": {
        "A": "As soon as the trap pin becomes ‘LOW’",
        "B": "By checking the trap pin for ‘high’ status at the end of execution of each instruction",
        "C": "By checking the trap pin for ‘high’ status at regular intervals",
        "D": "By checking the trap pin for ‘high’ status at the end of each instruction fetch"
        },
        "correct": "B"
    },
    {
        "question": "Which one of the following is true with regard to a CPU having a single interrupt request line and single interrupt grant line? i) Neither vectored nor multiple interrupting devices is possible. ii) Vectored interrupts is not possible but multiple interrupting devices is possible. iii) Vectored interrupts is possible and multiple interrupting devices is not possible. iv) Both vectored and multiple interrupting devices are possible. (chương 5)",
        "options": {
        "A": "iii, iv",
        "B": "i, iv",
        "C": "iii",
        "D": "ii, iii"
        },
        "correct": "C"
    },
    {
        "question": "From amongst the following given scenarios determine the right one to justify interrupt mode of data transfer. i) Bulk transfer of several kilo-byte; ii) Moderately large data transfer of more than 1kb; iii) Short events like mouse action; iv) Keyboard inputs (chương 5)",
        "options": {
        "A": "i, ii and iv",
        "B": "iv",
        "C": "i and ii",
        "D": "ii"
        },
        "correct": "B"
    },
//p3
    {
        "question": "The DMA controller has _______ registers. (chương 5)",
        "options": {
        "A": "2",
        "B": "4",
        "C": "1",
        "D": "3"
        },
        "correct": "D"
    },
    {
        "question": "To overcome the conflict over the possession of the BUS we use ______ (chương 5)",
        "options": {
        "A": "Multiple BUS structure",
        "B": "None of the mentioned",
        "C": "Optimizers",
        "D": "BUS arbitrators"
        },
        "correct": "D"
    },
    {
        "question": "In DMA transfers, the required signals and addresses are given by the __________ (chương 5)",
        "options": {
        "A": "Device drivers",
        "B": "The program itself",
        "C": "Processor",
        "D": "DMA controllers"
        },
        "correct": "D"
    },
    {
        "question": "The registers of the controller are ______ (chương 5)",
        "options": {
        "A": "64 bits",
        "B": "32 bits",
        "C": "24 bits",
        "D": "16 bits"
        },
        "correct": "B"
    },
    {
        "question": "The DMA differs from the interrupt mode by __________ (chương 5)",
        "options": {
        "A": "The amount of data transfer possible",
        "B": "None of the mentioned",
        "C": "The involvement of the processor for the operation",
        "D": "The method of accessing the I/O devices"
        },
        "correct": "C"
    },
    {
        "question": "The DMA transfers are performed by a control circuit called as __________ (chương 5)",
        "options": {
        "A": "DMA controller",
        "B": "Data controller",
        "C": "Device interface",
        "D": "Overlooker"
        },
        "correct": "A"
    },
    {
        "question": "The technique where the controller is given complete access to main memory is __________ (chương 5)",
        "options": {
        "A": "Cycle stealing",
        "B": "Burst mode",
        "C": "Memory Con",
        "D": "Memory stealing"
        },
        "correct": "B"
    },
    {
        "question": "The DMA transfer is initiated by _____ (chương 5)",
        "options": {
        "A": "I/O devices",
        "B": "The process being executed",
        "C": "Processor",
        "D": "OS"
        },
        "correct": "A"
    },
    {
        "question": "It is ______ that a single DMA controller can perform operations on two different disks simultaneously. (chương 5)",
        "options": {
        "A": "Not determined",
        "B": "Not possible",
        "C": "True",
        "D": "False"
        },
        "correct": "C"
    },
    {
        "question": "When the process requests for a DMA transfer? (chương 5)",
        "options": {
        "A": "Then the process is temporarily suspended",
        "B": "Another process gets executed",
        "C": "Process is temporarily suspended and Another process gets executed",
        "D": "The process continues execution"
        },
        "correct": "C"
    },
    {
        "question": "When the R/W bit of the status register of the DMA controller is set to 1. (chương 5)",
        "options": {
        "A": "Read operation is performed",
        "B": "Read and Write operation is performed",
        "C": "None of the mentioned",
        "D": "Write operation is performed"
        },
        "correct": "A"
    },
    {
        "question": "The controller uses _____ to help with the transfers when handling network interfaces. (chương 5)",
        "options": {
        "A": "Signal enhancers",
        "B": "Bridge circuits",
        "C": "Input Buffer storage",
        "D": "All of the mentioned"
        },
        "correct": "C"
    },
    {
        "question": "The controller is connected to the ____ (chương 5)",
        "options": {
        "A": "None of the mentioned",
        "B": "External BUS",
        "C": "System BUS",
        "D": "Processor BUS"
        },
        "correct": "C"
    },
    {
        "question": "After the completion of the DMA transfer, the processor is notified by __________ (chương 5)",
        "options": {
        "A": "Acknowledge signal",
        "B": "None of the mentioned",
        "C": "Interrupt signal",
        "D": "WMFC signal"
        },
        "correct": "C"
    },
    {
        "question": "The technique whereby the DMA controller steals the access cycles of the processor to operate is called __________ (chương 5)",
        "options": {
        "A": "Memory Con",
        "B": "Fast conning",
        "C": "Memory stealing",
        "D": "Cycle stealing"
        },
        "correct": "D"
    }
        ];

        const chapters = {
            1: questions.filter(q => q.question.includes("(chương 1)")),
            2: questions.filter(q => q.question.includes("(chương 2)")),
            3: questions.filter(q => q.question.includes("(chương 3)")),
            4: questions.filter(q => q.question.includes("(chương 4)")),
            5: questions.filter(q => q.question.includes("(chương 5)"))
        };
        let currentChapterQuestions = [];
        let correctAnswersCount = 0;
        let answersState = []; // Stores the state of each question's answer: { selected: 'A'|'B'|null (chưa chọn), completed: true/false }

        let currentMode = 'practice'; // 'practice' hoặc 'test'
        let timerInterval;
        let timeLeft = 0; // Giây
        let totalTestDuration = 0; // Tổng thời gian làm bài thi thử (tính bằng giây, dựa trên input của người dùng)

        // DOM elements
        const audio = document.getElementById('background-music');
        const toggleAudioBtn = document.getElementById('toggle-audio');
        const playlistContainer = document.getElementById('playlist');
        const scoreCounter = document.getElementById('score-counter');
        const chapterSelect = document.getElementById('chapter-select');
        const startQuizBtn = document.getElementById('start-quiz');
        const startScreen = document.getElementById('start-screen');
        const quizContainer = document.getElementById('quiz-container');
        const finalResultContainer = document.getElementById('final-result-container');
        const finalResultSummary = document.getElementById('final-result');
        const resultsDetailTableBody = document.querySelector('#results-detail-table tbody'); 
        const iconOn = document.querySelector('.icon-on');
        const iconOff = document.querySelector('.icon-off');
        const navGrid = document.getElementById('nav-grid');
        const allQuestionsDisplayArea = document.getElementById('all-questions-display-area');

        const practiceModeBtn = document.getElementById('practice-mode-btn');
        const testModeBtn = document.getElementById('test-mode-btn');
        const timerDisplay = document.getElementById('timer');
        const testDurationOptionDiv = document.getElementById('test-duration-option');
        const useTimerYesRadio = document.getElementById('use-timer-yes');
        const useTimerNoRadio = document.getElementById('use-timer-no');
        const testMinutesContainer = document.getElementById('test-minutes-container');
        const testMinutesInput = document.getElementById('test-minutes');

        const submitTestButton = document.createElement('button'); // Tạo nút submit động
        submitTestButton.id = 'submit-test-button';
        submitTestButton.classList.add('quiz-button');
        submitTestButton.textContent = 'Nộp bài thi';
        

        // Audio state variables
        let isAudioPlaying = false;
        let currentTrack = null;
        const playlist = [
            { value: 'tiktik.mp3', name: 'Clock Tick' },
            { value: 'MatKetNoi.mp3', name: 'Mất Kết Nối' },
            { value: 'NhacKhongLoiGuitar.mp3', name: 'Nhạc Không Lời Guitar' },
            { value: 'GapEmDungLuc.mp3', name: 'Gặp Em Đúng Lúc' },
            { value: 'TuoiTreTheHeBacHo.mp3', name: 'Tuổi Trẻ Thế Hệ Bác Hồ' },
            { value: 'NhacThai.mp3', name: 'Nhạc Thái Lan' }
        ];

        // --- Audio Functions ---
        function updateAudioButtonUI() {
            iconOn.style.display = isAudioPlaying ? 'block' : 'none';
            iconOff.style.display = isAudioPlaying ? 'none' : 'block';
        }

        toggleAudioBtn.addEventListener('click', () => {
            isAudioPlaying = !isAudioPlaying;
            if (isAudioPlaying) {
                if (audio.src) audio.play().catch(e => console.log('Autoplay prevented'));
                playlistContainer.style.display = 'block';
            } else {
                audio.pause();
                playlistContainer.style.display = 'none';
            }
            updateAudioButtonUI();
        });

        function initPlaylist() {
            playlistContainer.innerHTML = '';
            playlist.forEach(track => {
                const item = document.createElement('div');
                item.classList.add('playlist-item');
                item.textContent = track.name;
                item.dataset.src = track.value;
                item.addEventListener('click', () => {
                    selectTrack(track);
                    playlistContainer.style.display = 'none';
                });
                playlistContainer.appendChild(item);
            });
            selectTrack(playlist[2], false); 
        }

        function selectTrack(track, shouldPlay = true) {
            currentTrack = track;
            audio.src = track.value;
            audio.loop = true;
            updatePlaylistUI();
            if (isAudioPlaying && shouldPlay) {
                audio.play().catch(e => console.log('Autoplay prevented'));
            }
        }

        function updatePlaylistUI() {
            document.querySelectorAll('.playlist-item').forEach(item => {
                item.classList.toggle('playing', item.dataset.src === currentTrack.value);
            });
        }
        // --- End Audio Functions ---

        // --- Utility Functions ---
        function updateScoreCounter() {
            scoreCounter.textContent = `Số câu đúng: ${correctAnswersCount}/${currentChapterQuestions.length}`;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function shuffleOptions(question) {
            const optionsArray = shuffleArray(Object.entries(question.options));
            return Object.fromEntries(optionsArray);
        }

        function shuffleQuestions(questionsArray) {
            return shuffleArray([...questionsArray]).map(q => ({ ...q, options: shuffleOptions(q) }));
        }
        // --- End Utility Functions ---

        // --- Question Navigation Panel Functions ---
        function renderQuestionNavPanel() {
            navGrid.innerHTML = '';
            currentChapterQuestions.forEach((_, index) => {
                const navBtn = document.createElement('button');
                navBtn.classList.add('nav-question-btn');
                navBtn.textContent = index + 1;
                navBtn.dataset.index = index;
                navBtn.addEventListener('click', () => jumpToQuestion(index));
                navGrid.appendChild(navBtn);
            });
            updateNavPanelUI(); // Cập nhật màu ban đầu của các nút điều hướng
        }

        function updateNavPanelUI() {
            const navButtons = document.querySelectorAll('.nav-question-btn');
            navButtons.forEach((btn, index) => {
                btn.className = 'nav-question-btn'; // Reset class
                const answer = answersState[index];

                if (currentMode === 'practice') { // Chế độ luyện tập: hiển thị màu ngay
                    if (answer && answer.completed) {
                        if (answer.selected === currentChapterQuestions[index].correct) {
                            btn.classList.add('answered-correct');
                        } else if (answer.selected === 'revealed') {
                            btn.classList.add('answered-skipped'); 
                        } else {
                            btn.classList.add('answered-incorrect');
                        }
                    }
                } else { // Chế độ thi thử: chỉ hiển thị màu sau khi nộp bài (được gọi từ showResult)
                    if (answer && answer.completed) {
                        // Trong chế độ thi thử, trước khi nộp bài, chỉ cần biết đã làm (không phân biệt đúng sai)
                        // Nên thêm class 'answered-in-test' để đổi màu nhạt
                        btn.classList.add('answered-in-test'); 
                    }
                    // Các màu đúng/sai/bỏ qua sẽ được áp dụng trong showResult()
                }
            });
        }

        function jumpToQuestion(index) {
            const questionElement = document.getElementById(`question-${index}`);
            if (questionElement) {
                // Sử dụng scrollIntoView với options để tính đến padding cố định của header
                questionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        // --- End Question Navigation Panel Functions ---

        // --- Render All Questions in Chapter ---
        function renderAllQuestionsInChapter() {
            allQuestionsDisplayArea.innerHTML = ''; 
            
            currentChapterQuestions.forEach((q, qIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('single-question-display');
                if (currentMode === 'test') { 
                    questionDiv.classList.add('test-mode');
                }
                questionDiv.id = `question-${qIndex}`;
                questionDiv.setAttribute('data-question-index', qIndex);

                const questionImageHtml = q.imageUrl ? `<img src="${q.imageUrl}" alt="Hình ảnh câu hỏi ${qIndex + 1}">` : '';

                questionDiv.innerHTML = `
                    <p class="question-text">Câu ${qIndex + 1}: ${q.question}</p>
                    ${questionImageHtml}
                    <ul class="options" id="options-${qIndex}"></ul>
                    <button class="hint-button" title="Gợi ý đáp án">
                        <img src="https://img.icons8.com/fluency/48/light-on.png" alt="Gợi ý" style="width:24px; height:24px;">
                    </button>
                    <div class="answer-feedback-area" id="feedback-area-${qIndex}"></div> 
                `;

                allQuestionsDisplayArea.appendChild(questionDiv);

                const optionsList = questionDiv.querySelector(`#options-${qIndex}`);
                let optionCounter = 0;
                for (const [key, value] of Object.entries(q.options)) {
                    const optionId = `q${qIndex}_option_${optionCounter++}`;
                    const optionItem = document.createElement('li');
                    optionItem.classList.add('option-item');
                    
                    optionItem.innerHTML = `
                        <input type="radio" name="q${qIndex}_answer" value="${key}" id="${optionId}">
                        <span class="custom-radio"><span class="icon"></span></span>
                        <label for="${optionId}">${value}</label>
                    `;
                    optionsList.appendChild(optionItem);

                    // Add click event to each option item
                    optionItem.addEventListener('click', function() {
                        // Trong practice mode, khóa câu hỏi nếu đã trả lời
                        // Trong test mode, luôn cho phép chọn lại đáp án cho đến khi nộp bài
                        if (currentMode === 'practice' && (answersState[qIndex] && answersState[qIndex].completed)) {
                            return; // Đã trả lời trong practice mode, không làm gì nữa.
                        }

                        const radio = this.querySelector('input[type="radio"]');
                        radio.checked = true;
                        
                        // Cập nhật trạng thái câu trả lời
                        answersState[qIndex] = { selected: radio.value, completed: true };

                        // Gọi processAnswer để xử lý logic hiển thị và cập nhật điểm/UI
                        processAnswer(qIndex, radio.value);
                    });
                }

                const hintButton = questionDiv.querySelector('.hint-button');
                if (currentMode === 'test') {
                    hintButton.style.display = 'none'; 
                } else {
                    hintButton.style.display = 'inline-block'; 
                }
                hintButton.addEventListener('click', function() {
                    const currentQuestionAnswerState = answersState[qIndex];
                    if (!(currentQuestionAnswerState && currentQuestionAnswerState.completed)) {
                                showCorrectAnswerSpecific(qIndex, q.correct);
                    } else {
                        hintButton.disabled = true;
                    }
                });

                // Khôi phục trạng thái (lưu ý: chỉ vô hiệu hóa tương tác trong practice mode hoặc sau khi nộp bài)
                const answerState = answersState[qIndex];
                if (answerState && answerState.completed) {
                    restoreQuestionState(qIndex, questionDiv, q, answerState);
                }
            });

            // Quan trọng: Đảm bảo nút Nộp bài được thêm vào #main-quiz-area
            if (currentMode === 'test') {
                // Kiểm tra nếu nút submit đã có trong DOM thì không cần thêm lại, chỉ hiển thị nó
                if (!document.getElementById('submit-test-button')) {
                    allQuestionsDisplayArea.appendChild(submitTestButton); 
                }
                submitTestButton.style.display = 'block'; 
            } else {
                // Ẩn nút nếu không ở chế độ test
                if (document.getElementById('submit-test-button')) {
                    submitTestButton.style.display = 'none'; 
                }
            }
        }

        // Hàm khôi phục trạng thái UI của câu hỏi (dùng khi load lại hoặc chuyển chương)
        function restoreQuestionState(qIndex, questionElement, q, answerState) {
            // Trong practice mode, câu hỏi đã trả lời sẽ bị khóa và hiển thị màu
            if (currentMode === 'practice') {
                questionElement.classList.add('answered'); 
                const optionsList = questionElement.querySelector('.options');
                const hintButton = questionElement.querySelector('.hint-button'); 

                Array.from(optionsList.children).forEach(item => { 
                    const radio = item.querySelector('input[type="radio"]');
                    item.style.pointerEvents = 'none'; // Vô hiệu hóa tương tác cho các option đã làm
                    radio.disabled = true;

                    // Xóa tất cả các style/class màu sắc đã áp dụng trước đó
                    item.classList.remove('selected-correct', 'selected-incorrect', 'correct-revealed', 'chosen-correct', 'chosen-incorrect', 'correct-answer-highlight');
                    item.style.backgroundColor = ''; 
                    item.style.borderColor = ''; 
                    item.style.boxShadow = ''; 
                    item.style.opacity = ''; 
                    item.querySelector('label').style.color = ''; 
                    item.querySelector('.custom-radio').style.backgroundColor = ''; 
                    item.querySelector('.custom-radio').style.borderColor = ''; 
                    item.querySelector('.custom-radio .icon').style.opacity = '0'; 
                    radio.checked = false; 

                    if (answerState.selected === 'revealed') {
                        if (radio.value === q.correct) {
                            item.classList.add('correct-revealed');
                        } else {
                            item.style.opacity = '0.6';
                            item.querySelector('label').style.color = '#6c757d';
                        }
                    } else if (answerState.selected) { 
                        if (radio.value === answerState.selected) { 
                            if (radio.value === q.correct) {
                                item.classList.add('chosen-correct');
                            } else {
                                item.classList.add('chosen-incorrect');
                            }
                            radio.checked = true; 
                        } else if (radio.value === q.correct) { 
                            item.classList.add('correct-answer-highlight');
                        } else { 
                            item.style.opacity = '0.6';
                            item.querySelector('label').style.color = '#6c757d';
                        }
                    }
                });

                hintButton.disabled = true; 
                hintButton.style.display = 'inline-block';
            } else { // Trong test mode, không vô hiệu hóa tương tác (cho phép chọn lại)
                // Chỉ đảm bảo lựa chọn đã chọn trước đó được đánh dấu
                const radio = questionElement.querySelector(`input[value="${answerState.selected}"]`);
                if(radio) {
                    radio.checked = true;
                    const customRadio = radio.nextElementSibling;
                    customRadio.style.backgroundColor = 'var(--primary-color)';
                    customRadio.style.borderColor = 'var(--primary-color)';
                }
                questionElement.classList.remove('answered'); // Rất quan trọng: loại bỏ class answered để không kích hoạt CSS vô hiệu hóa
                questionElement.classList.add('test-mode'); // Đảm bảo class test-mode được giữ
                // Nút gợi ý đã bị ẩn bởi CSS nếu là .test-mode .hint-button { display: none; }
                const hintButton = questionElement.querySelector('.hint-button');
                if (hintButton) hintButton.style.display = 'none';
            }
        }

        // --- Xử lý Đáp án & Phản hồi ---
        function processAnswer(qIndex, selectedValue) {
            const q = currentChapterQuestions[qIndex];
            const questionElement = document.getElementById(`question-${qIndex}`);
            const hintButton = questionElement.querySelector('.hint-button');
            const optionsList = questionElement.querySelector('.options');

            // Cập nhật answersState
            answersState[qIndex] = { selected: selectedValue, completed: true }; // Ghi nhận là đã có lựa chọn

            // Cập nhật điểm ngay trong chế độ luyện tập
            if (currentMode === 'practice') { 
                // Cần tính lại correctAnswersCount mỗi khi có thay đổi trong answersState
                // Để đảm bảo điểm số chính xác nếu người dùng chọn lại đáp án
                correctAnswersCount = 0; // Reset
                answersState.forEach((ans, idx) => {
                    if (ans && ans.selected === currentChapterQuestions[idx].correct) {
                        correctAnswersCount++;
                    }
                });
                updateScoreCounter(); // Cập nhật hiển thị điểm
            }
            
            if (currentMode === 'practice') {
                questionElement.classList.add('answered'); // Kích hoạt CSS vô hiệu hóa/màu sắc
                Array.from(optionsList.children).forEach(item => { 
                    const radio = item.querySelector('input');
                    item.style.pointerEvents = 'none'; // Vô hiệu hóa tương tác
                    radio.disabled = true;

                    item.classList.remove('selected-correct', 'selected-incorrect', 'correct-revealed', 'chosen-correct', 'chosen-incorrect', 'correct-answer-highlight');
                    item.style.backgroundColor = ''; 
                    item.style.borderColor = ''; 
                    item.style.boxShadow = ''; 
                    item.style.opacity = ''; 
                    item.querySelector('label').style.color = ''; 
                    item.querySelector('.custom-radio .icon').style.opacity = '0'; 

                    if (radio.value === selectedValue) { 
                        if (selectedValue === q.correct) {
                            item.classList.add('chosen-correct'); 
                        } else {
                            item.classList.add('chosen-incorrect'); 
                        }
                    } else if (radio.value === q.correct) { 
                        if (selectedValue !== q.correct) { 
                            item.classList.add('correct-answer-highlight'); 
                        }
                    }
                    else { 
                        item.style.opacity = '0.6';
                        item.querySelector('label').style.color = '#6c757d';
                    }
                });
                hintButton.disabled = true; 

                // QUAN TRỌNG: Cập nhật màu nút điều hướng bên phải ngay sau khi xử lý câu trả lời trong luyện tập
                updateNavPanelUI(); 

                const allCompleted = answersState.every(ans => ans.completed);
                if (allCompleted) {
                    setTimeout(showResult, 500); 
                }
            } else { // currentMode === 'test'
                // Trong chế độ thi thử:
                // 1. Không thay đổi màu sắc của các option-item ngay lập tức (CSS body.test-mode-active lo liệu)
                // 2. Vẫn cho phép thay đổi lựa chọn (không vô hiệu hóa pointer-events/disabled)
                // 3. Đảm bảo radio button đã chọn được checked (logic HTML và CSS auto xử lý)
                // 4. Cập nhật nút điều hướng bên phải để hiển thị trạng thái "đã làm" (màu xám nhạt)
                updateNavPanelUI(); // Đây là nơi quan trọng để cập nhật màu nút bên phải
                // Không gọi showResult() ở đây. Sẽ được gọi khi nộp bài hoặc hết giờ.
            }
        }

        // Hàm để hiển thị đáp án đúng khi nhấn nút "Gợi ý" (chỉ trong chế độ luyện tập)
        function showCorrectAnswerSpecific(qIndex, correctAnswerValue, isReloading = false) {
            if (currentMode === 'test') return; // Không cho phép gợi ý trong chế độ test

            const q = currentChapterQuestions[qIndex]; 
            const questionElement = document.getElementById(`question-${qIndex}`);
            const optionsList = questionElement.querySelector('.options');
            const hintButton = questionElement.querySelector('.hint-button');
            
            if (!isReloading && answersState[qIndex].selected !== 'revealed') {
                answersState[qIndex].selected = 'revealed';
                answersState[qIndex].completed = true;
            }

            Array.from(optionsList.children).forEach(item => { 
                const radio = item.querySelector('input');
                item.style.pointerEvents = 'none'; 
                radio.disabled = true;

                item.classList.remove('selected-correct', 'selected-incorrect', 'chosen-correct', 'chosen-incorrect', 'correct-answer-highlight', 'correct-revealed');
                item.style.opacity = ''; 
                item.querySelector('label').style.color = ''; 
                item.querySelector('.custom-radio .icon').style.opacity = '0'; 

                if (radio.value === correctAnswerValue) {
                    item.classList.add('correct-revealed'); 
                } else {
                    item.style.opacity = '0.6';
                    item.querySelector('label').style.color = '#6c757d';
                }
            });

            hintButton.disabled = true; 
            updateNavPanelUI(); 

            if (currentMode === 'practice') {
                const allCompleted = answersState.every(ans => ans.completed);
                if (allCompleted) {
                    setTimeout(showResult, 500); 
                }
            }
        }

        // --- Hàm thời gian ---
        function startTimer() {
            clearInterval(timerInterval); 
            
            // Nếu người dùng chọn "Không" sử dụng thời gian
            if (useTimerNoRadio.checked) {
                totalTestDuration = 0; // Đặt tổng thời gian về 0
                timeLeft = 0; // Đặt thời gian còn lại về 0
                timerDisplay.style.display = 'none'; // Ẩn hiển thị thời gian
                // Không khởi tạo setInterval nếu không sử dụng thời gian
            } else {
                const minutes = parseInt(testMinutesInput.value, 10);
                // Kiểm tra giá trị hợp lệ của phút
                if (isNaN(minutes) || minutes <= 0) {
                    alert("Vui lòng nhập số phút hợp lệ (lớn hơn 0). Mặc định 10 phút.");
                    testMinutesInput.value = 10; // Đặt lại giá trị mặc định
                    totalTestDuration = 10 * 60;
                } else {
                    totalTestDuration = minutes * 60; 
                }
                
                timeLeft = totalTestDuration;
                updateTimerDisplay(); // Cập nhật hiển thị ban đầu

                timerDisplay.style.display = 'block'; // Hiển thị thời gian
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        alert("Hết giờ làm bài!");
                        showResult(); 
                    }
                }, 1000);
            }
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `Thời gian: ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // --- Điều hướng & Đặt lại ---
        function showResult() {
            stopTimer(); 
            audio.pause();
            quizContainer.style.display = 'none';
            finalResultContainer.style.display = 'block';
            
            let finalCorrectAnswers = 0;
            
            resultsDetailTableBody.innerHTML = ''; 

            answersState.forEach((ans, index) => {
                const q = currentChapterQuestions[index];
                const row = resultsDetailTableBody.insertRow();
                
                const questionNumCell = row.insertCell();
                questionNumCell.textContent = index + 1;

                const questionTextCell = row.insertCell();
                questionTextCell.textContent = q.question.replace(/\s*\(chương\s+\d+\)/i, ''); 

                const userAnswerCell = row.insertCell();
                const correctAnswerCell = row.insertCell();
                const statusCell = row.insertCell();

                let statusText = '';
                let statusClass = '';
                let userAnswerText = 'Chưa trả lời';

                if (ans.completed) {
                    if (ans.selected === q.correct) {
                        finalCorrectAnswers++; 
                        userAnswerText = q.options[ans.selected];
                        statusText = 'Đúng';
                        statusClass = 'status-correct';
                    } else if (ans.selected === 'revealed') { 
                        userAnswerText = q.options[q.correct] + ' (Gợi ý)'; 
                        statusText = 'Bỏ qua';
                        statusClass = 'status-skipped';
                    } else { 
                        userAnswerText = q.options[ans.selected];
                        statusText = 'Sai';
                        statusClass = 'status-incorrect';
                    }
                } else {
                    userAnswerText = 'Chưa trả lời';
                    statusText = 'Bỏ qua';
                    statusClass = 'status-skipped'; 
                }

                userAnswerCell.textContent = userAnswerText;
                correctAnswerCell.textContent = q.options[q.correct];
                statusCell.textContent = statusText;
                statusCell.classList.add(statusClass);
            });

            const score = (finalCorrectAnswers / currentChapterQuestions.length) * 10;
            let message = '';
            if (score === 10) message = "Xuất sắc! Bạn đạt điểm tuyệt đối! 🌟";
            else if (score >= 8) message = "Rất tốt! Bạn nắm vững kiến thức. 👏";
            else if (score >= 5) message = "Khá tốt, nhưng bạn có thể cải thiện thêm. 💪";
            else message = "Bạn cần ôn tập thêm nhé! 📚";
    
            // Hiển thị thời gian làm bài, nếu không giới hạn thời gian thì ghi "Không giới hạn"
            const timeTakenDisplay = (totalTestDuration === 0 && useTimerNoRadio.checked) ? "Không giới hạn" : formatTime(totalTestDuration - timeLeft);

            finalResultSummary.innerHTML = `
                <h2>Kết quả của bạn</h2> 
                <p>Số câu đúng: <span class="correct">${finalCorrectAnswers}</span>/${currentChapterQuestions.length}</p> 
                <p>Điểm của bạn: <span class="score-value">${score.toFixed(2)}</span></p>
                <p>${message}</p> 
                <p>Thời gian làm bài: ${timeTakenDisplay}</p>
            `;

            // Áp dụng lại màu sắc và trạng thái cho các câu hỏi trên giao diện chính sau khi nộp bài (đặc biệt cho test mode)
            currentChapterQuestions.forEach((q, qIndex) => {
                const questionElement = document.getElementById(`question-${qIndex}`);
                const optionsList = questionElement.querySelector('.options');
                const ansState = answersState[qIndex]; 

                questionElement.classList.add('answered'); 
                // Xóa class test-mode để các style đúng/sai/gợi ý có thể áp dụng sau khi nộp bài
                questionElement.classList.remove('test-mode'); 

                Array.from(optionsList.children).forEach(item => { 
                    const radio = item.querySelector('input[type="radio"]');
                    item.style.pointerEvents = 'none'; // Vô hiệu hóa tương tác
                    radio.disabled = true;

                    // Clear any previous generic test mode styling or initial states
                    item.classList.remove('chosen-correct', 'chosen-incorrect', 'correct-answer-highlight', 'correct-revealed');
                    item.style.backgroundColor = ''; 
                    item.style.borderColor = '';
                    item.style.boxShadow = '';
                    item.style.opacity = '';
                    item.querySelector('label').style.color = '';
                    item.querySelector('.custom-radio').style.backgroundColor = '';
                    item.querySelector('.custom-radio').style.borderColor = '';
                    item.querySelector('.custom-radio .icon').style.opacity = '';

                    if (ansState.completed) {
                        if (radio.value === ansState.selected && ansState.selected === q.correct) {
                            item.classList.add('chosen-correct');
                        } else if (radio.value === ansState.selected && ansState.selected !== q.correct) {
                            item.classList.add('chosen-incorrect');
                        } else if (radio.value === q.correct && ansState.selected !== q.correct && ansState.selected !== 'revealed') { 
                            item.classList.add('correct-answer-highlight');
                        } else if (radio.value === q.correct && ansState.selected === 'revealed') {
                            item.classList.add('correct-revealed');
                        }
                        else { 
                            item.style.opacity = '0.6';
                            item.querySelector('label').style.color = '#6c757d';
                        }
                    } else { // Câu hỏi chưa được trả lời (bị bỏ qua)
                        item.style.opacity = '0.6';
                        item.querySelector('label').style.color = '#6c757d';
                    }

                     // Đảm bảo icon của custom-radio được cập nhật theo class mới
                    const customRadio = item.querySelector('.custom-radio');
                    const icon = customRadio.querySelector('.icon');
                    if (item.classList.contains('chosen-correct') || item.classList.contains('correct-answer-highlight')) {
                        icon.textContent = '✓';
                        icon.style.opacity = '1';
                        icon.style.transform = 'scale(1)';
                        customRadio.style.backgroundColor = 'var(--white-color)';
                        customRadio.style.borderColor = 'var(--white-color)';
                        icon.style.color = 'var(--correct-color)';
                    } else if (item.classList.contains('chosen-incorrect')) {
                        icon.textContent = '✗';
                        icon.style.opacity = '1';
                        icon.style.transform = 'scale(1)';
                        customRadio.style.backgroundColor = 'var(--white-color)';
                        customRadio.style.borderColor = 'var(--white-color)';
                        icon.style.color = 'var(--incorrect-color)';
                    } else if (item.classList.contains('correct-revealed')) { 
                        icon.textContent = '✓';
                        icon.style.opacity = '1';
                        icon.style.transform = 'scale(1)';
                        customRadio.style.backgroundColor = 'var(--white-color)';
                        customRadio.style.borderColor = 'var(--white-color)';
                        icon.style.color = 'var(--skipped-color)'; 
                    }
                     else {
                        icon.style.opacity = '0'; 
                    }
                });
                const hintButton = questionElement.querySelector('.hint-button');
                if (hintButton) hintButton.style.display = 'none'; 
            });

            // Cập nhật lại màu sắc cho các nút điều hướng bên phải sau khi nộp bài
            updateNavPanelUI();
            document.body.classList.remove('test-mode-active'); // Xóa class test-mode-active sau khi nộp
        }
        
        function resetQuizState() {
            correctAnswersCount = 0;
            answersState = []; // Reset toàn bộ answersState
            finalResultContainer.style.display = 'none';
            updateScoreCounter();
            stopTimer(); 
            timerDisplay.style.display = 'none'; 
            // Ẩn nút nộp bài khi reset (nếu nó đang hiển thị)
            if (submitTestButton.parentNode) { 
                submitTestButton.style.display = 'none'; 
            }
            document.body.classList.remove('test-mode-active'); 
        }

        function restartQuiz() {
            resetQuizState();
            currentChapterQuestions = shuffleQuestions(currentChapterQuestions);
            answersState = Array(currentChapterQuestions.length).fill(null).map(() => ({ selected: null, completed: false }));
            updateScoreCounter();
            renderQuestionNavPanel();
            renderAllQuestionsInChapter(); 
            quizContainer.style.display = 'block';
            if (isAudioPlaying) audio.play().catch(e => console.log(e));
            
            if (currentMode === 'test') {
                startTimer(); 
                timerDisplay.style.display = useTimerNoRadio.checked ? 'none' : 'block'; // Chỉ hiện timer nếu có dùng thời gian
                document.body.classList.add('test-mode-active'); 
            } else {
                timerDisplay.style.display = 'none'; 
                document.body.classList.remove('test-mode-active');
            }
        }

        function backToChapterSelection() {
            resetQuizState();
            quizContainer.style.display = 'none';
            startScreen.style.display = 'block';
            updateModeButtons(); 
            testDurationOptionDiv.style.display = (currentMode === 'test') ? 'block' : 'none'; 
            testMinutesContainer.style.display = useTimerYesRadio.checked ? 'block' : 'none'; // Điều khiển hiển thị ô nhập phút
        }
        
        // --- Event Listeners ---
        startQuizBtn.addEventListener('click', () => {
            const selectedChapterValue = chapterSelect.value;
            if (selectedChapterValue === 'all') {
                currentChapterQuestions = shuffleQuestions(questions);
            } else {
                currentChapterQuestions = shuffleQuestions(chapters[selectedChapterValue]);
            }

            if (currentChapterQuestions.length === 0) {
                alert("Chương này không có câu hỏi nào.");
                return;
            }

            resetQuizState();
            answersState = Array(currentChapterQuestions.length).fill(null).map(() => ({ selected: null, completed: false }));

            updateScoreCounter();
            renderQuestionNavPanel();
            renderAllQuestionsInChapter(); // Hàm này sẽ thêm/hiển thị nút Nộp bài nếu ở chế độ Test
            startScreen.style.display = 'none';
            quizContainer.style.display = 'block';

            if (currentMode === 'test') {
                startTimer();
                timerDisplay.style.display = useTimerNoRadio.checked ? 'none' : 'block'; // Chỉ hiện timer nếu có dùng thời gian
                document.body.classList.add('test-mode-active'); 
            } else {
                stopTimer();
                timerDisplay.style.display = 'none'; 
                document.body.classList.remove('test-mode-active'); 
            }
        });

        submitTestButton.addEventListener('click', () => {
            const confirmSubmit = confirm("Bạn có chắc chắn muốn nộp bài thi? Bạn sẽ không thể thay đổi đáp án sau khi nộp.");
            if (confirmSubmit) {
                showResult();
            }
        });

        practiceModeBtn.addEventListener('click', () => {
            currentMode = 'practice';
            updateModeButtons();
            timerDisplay.style.display = 'none'; 
            testDurationOptionDiv.style.display = 'none'; // Ẩn toàn bộ phần tùy chỉnh thời gian
            document.body.classList.remove('test-mode-active'); 
        });

        testModeBtn.addEventListener('click', () => {
            currentMode = 'test';
            updateModeButtons();
            testDurationOptionDiv.style.display = 'block'; // Hiện toàn bộ phần tùy chỉnh thời gian
            // submitTestButton sẽ được quản lý bởi renderAllQuestionsInChapter()
            // document.body.classList.add('test-mode-active'); // Sẽ được thêm khi bắt đầu quiz
        });

        // Event listeners for "Có" / "Không" sử dụng thời gian
        useTimerYesRadio.addEventListener('change', () => {
            testMinutesContainer.style.display = useTimerYesRadio.checked ? 'block' : 'none';
        });

        useTimerNoRadio.addEventListener('change', () => {
            testMinutesContainer.style.display = useTimerYesRadio.checked ? 'block' : 'none';
        });


        function updateModeButtons() {
            practiceModeBtn.classList.toggle('selected', currentMode === 'practice');
            testModeBtn.classList.toggle('selected', currentMode === 'test');
            // Cập nhật hiển thị input thời gian khi chuyển đổi mode trên màn hình chính
            testDurationOptionDiv.style.display = (currentMode === 'test') ? 'block' : 'none';
            // Đảm bảo trạng thái của testMinutesContainer đúng theo useTimerYesRadio khi chuyển mode
            testMinutesContainer.style.display = (currentMode === 'test' && useTimerYesRadio.checked) ? 'block' : 'none';
        }

        // --- Initialization ---
        initPlaylist();
        updateAudioButtonUI();
        backToChapterSelection(); 
        updateModeButtons(); // Gọi lần đầu để thiết lập trạng thái mặc định (Luyện tập)
        timerDisplay.style.display = 'none'; // Đảm bảo đồng hồ ẩn khi khởi chạy
    </script>
</body>
</html>
